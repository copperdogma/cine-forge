recipe_id: world_building
description: "World building pipeline: entity bibles from pre-ingested artifacts."
project: {}
stages:
  - id: entity_discovery
    module: entity_discovery_v1
    params:
      discovery_model: "claude-haiku-4-5-20251001"
    needs: []
    store_inputs:
      normalize: canonical_script
    store_inputs_all:
      character_bible: character_bible
      location_bible: location_bible
      prop_bible: prop_bible

  - id: character_bible
    module: character_bible_v1
    params:
      skip_qa: true
    needs: [entity_discovery]
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index

  - id: location_bible
    module: location_bible_v1
    params:
      skip_qa: true
    needs: [entity_discovery]
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index

  - id: prop_bible
    module: prop_bible_v1
    params:
      skip_qa: true
    needs: [entity_discovery]
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index
