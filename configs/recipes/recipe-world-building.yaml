recipe_id: world_building
description: "World building pipeline: entity bibles from pre-ingested artifacts."
project: {}
stages:
  - id: character_bible
    module: character_bible_v1
    params:
      work_model: ${utility_model}
      verify_model: ${utility_model}
      escalate_model: ${sota_model}
      skip_qa: ${skip_qa}
    needs: []
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index

  - id: location_bible
    module: location_bible_v1
    params:
      work_model: ${utility_model}
      verify_model: ${utility_model}
      escalate_model: ${sota_model}
      skip_qa: ${skip_qa}
    needs: []
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index

  - id: prop_bible
    module: prop_bible_v1
    params:
      work_model: ${utility_model}
      verify_model: ${utility_model}
      escalate_model: ${sota_model}
      skip_qa: ${skip_qa}
    needs: []
    store_inputs:
      normalize: canonical_script
      extract_scenes: scene_index

  - id: entity_graph
    module: entity_graph_v1
    params:
      work_model: ${utility_model}
    needs: []
    needs_all: [character_bible, location_bible, prop_bible]
    store_inputs:
      extract_scenes: scene_index
