{
  "evalId": "eval-ukJ-2026-02-18T07:31:01",
  "results": {
    "version": 3,
    "timestamp": "2026-02-18T07:31:01.274Z",
    "prompts": [
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "GPT-4.1 Nano",
        "metrics": {
          "score": 1.2585000000000002,
          "testPassCount": 0,
          "testFailCount": 2,
          "testErrorCount": 0,
          "assertPassCount": 2,
          "assertFailCount": 2,
          "totalLatencyMs": 11878,
          "tokenUsage": {
            "prompt": 1491,
            "completion": 843,
            "cached": 0,
            "total": 2334,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2514,
              "prompt": 1457,
              "completion": 1057,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.00048630000000000006
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "GPT-4.1 Mini",
        "metrics": {
          "score": 1.31335,
          "testPassCount": 0,
          "testFailCount": 2,
          "testErrorCount": 0,
          "assertPassCount": 2,
          "assertFailCount": 2,
          "totalLatencyMs": 10593,
          "tokenUsage": {
            "prompt": 1491,
            "completion": 768,
            "cached": 0,
            "total": 2259,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2254,
              "prompt": 1392,
              "completion": 862,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.0018252000000000001
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "GPT-4.1",
        "metrics": {
          "score": 1.53585,
          "testPassCount": 1,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 3,
          "assertFailCount": 1,
          "totalLatencyMs": 11348,
          "tokenUsage": {
            "prompt": 1491,
            "completion": 777,
            "cached": 0,
            "total": 2268,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2004,
              "prompt": 1417,
              "completion": 587,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.009198
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "Claude Haiku 4.5",
        "metrics": {
          "score": 1.5625,
          "testPassCount": 1,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 3,
          "assertFailCount": 1,
          "totalLatencyMs": 7779,
          "tokenUsage": {
            "prompt": 1674,
            "completion": 973,
            "cached": 0,
            "total": 2647,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2640,
              "prompt": 1733,
              "completion": 907,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.0065390000000000005
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "Claude Sonnet 4.5",
        "metrics": {
          "score": 1.5675,
          "testPassCount": 2,
          "testFailCount": 0,
          "testErrorCount": 0,
          "assertPassCount": 4,
          "assertFailCount": 0,
          "totalLatencyMs": 17274,
          "tokenUsage": {
            "prompt": 1674,
            "completion": 928,
            "cached": 0,
            "total": 2602,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2645,
              "prompt": 1688,
              "completion": 957,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.018942
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "Claude Sonnet 4.6",
        "metrics": {
          "score": 1.78,
          "testPassCount": 2,
          "testFailCount": 0,
          "testErrorCount": 0,
          "assertPassCount": 4,
          "assertFailCount": 0,
          "totalLatencyMs": 21323,
          "tokenUsage": {
            "prompt": 1674,
            "completion": 1076,
            "cached": 0,
            "total": 2750,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2604,
              "prompt": 1703,
              "completion": 901,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "GPT-5.2",
        "metrics": {
          "score": 1.59835,
          "testPassCount": 1,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 3,
          "assertFailCount": 1,
          "totalLatencyMs": 16654,
          "tokenUsage": {
            "prompt": 1489,
            "completion": 1042,
            "cached": 0,
            "total": 2531,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2542,
              "prompt": 1656,
              "completion": 886,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.01719375
        }
      },
      {
        "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
        "id": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "provider": "Claude Opus 4.6",
        "metrics": {
          "score": 1.625,
          "testPassCount": 2,
          "testFailCount": 0,
          "testErrorCount": 0,
          "assertPassCount": 4,
          "assertFailCount": 0,
          "totalLatencyMs": 24564,
          "tokenUsage": {
            "prompt": 1674,
            "completion": 1220,
            "cached": 0,
            "total": 2894,
            "numRequests": 2,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 2966,
              "prompt": 1980,
              "completion": 986,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.03887
        }
      }
    ],
    "results": [
      {
        "cost": 0.00020180000000000003,
        "error": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense' rather than dark comedy. The skull fragment is mentioned but framed as a 'revelation' rather than dark humor. The muzak contrast is completely absent from the output. This is a significant miss - the scene's dark comedy tone (violence juxtaposed with elevator muzak) is a key tonal element. Fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, there's a character_introduction beat for Rose and Mariner, and a character_development beat noting Mariner's physical appearance and gear. Partial pass - it mentions it but doesn't capture the specifics of the costume description well.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, explicitly identified as a conflict beat about the AirTag tracking, noting tension and mistrust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak element is completely missing from the enrichment. This is a critical miss for capturing subtext and tonal nuance. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are somewhat grounded but could be more specific. The skull fragment beat is present, the AirTag beat is present, but the muzak/tonal contrast is missing. The beats are somewhat generic (e.g., 'recent violence or conflict' is vague). Partial.\n\nOverall: The enrichment captures the basic plot elements (location, characters, key events) but misses the crucial tonal nuance - the dark comedy and juxtaposition of mundane elevator muzak against extreme violence. The tone is labeled as merely 'tense' when it should reflect dark comedy or absurdist humor. The rubric specifically states 'good enrichment captures subtext and tonal nuance, not just plot,' and this output largely captures plot without the deeper tonal layer.",
        "gradingResult": {
          "pass": false,
          "score": 0.616,
          "reason": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense' rather than dark comedy. The skull fragment is mentioned but framed as a 'revelation' rather than dark humor. The muzak contrast is completely absent from the output. This is a significant miss - the scene's dark comedy tone (violence juxtaposed with elevator muzak) is a key tonal element. Fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, there's a character_introduction beat for Rose and Mariner, and a character_development beat noting Mariner's physical appearance and gear. Partial pass - it mentions it but doesn't capture the specifics of the costume description well.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, explicitly identified as a conflict beat about the AirTag tracking, noting tension and mistrust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak element is completely missing from the enrichment. This is a critical miss for capturing subtext and tonal nuance. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are somewhat grounded but could be more specific. The skull fragment beat is present, the AirTag beat is present, but the muzak/tonal contrast is missing. The beats are somewhat generic (e.g., 'recent violence or conflict' is vague). Partial.\n\nOverall: The enrichment captures the basic plot elements (location, characters, key events) but misses the crucial tonal nuance - the dark comedy and juxtaposition of mundane elevator muzak against extreme violence. The tone is labeled as merely 'tense' when it should reflect dark comedy or absurdist humor. The rubric specifically states 'good enrichment captures subtext and tonal nuance, not just plot,' and this output largely captures plot without the deeper tonal layer.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1171,
            "prompt": 636,
            "completion": 535,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.782,
              "reason": "beat_quality=0.88 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=0.88 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'UNSPECIFIED', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": false,
              "score": 0.45,
              "reason": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense' rather than dark comedy. The skull fragment is mentioned but framed as a 'revelation' rather than dark humor. The muzak contrast is completely absent from the output. This is a significant miss - the scene's dark comedy tone (violence juxtaposed with elevator muzak) is a key tonal element. Fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, there's a character_introduction beat for Rose and Mariner, and a character_development beat noting Mariner's physical appearance and gear. Partial pass - it mentions it but doesn't capture the specifics of the costume description well.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, explicitly identified as a conflict beat about the AirTag tracking, noting tension and mistrust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak element is completely missing from the enrichment. This is a critical miss for capturing subtext and tonal nuance. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are somewhat grounded but could be more specific. The skull fragment beat is present, the AirTag beat is present, but the muzak/tonal contrast is missing. The beats are somewhat generic (e.g., 'recent violence or conflict' is vague). Partial.\n\nOverall: The enrichment captures the basic plot elements (location, characters, key events) but misses the crucial tonal nuance - the dark comedy and juxtaposition of mundane elevator muzak against extreme violence. The tone is labeled as merely 'tense' when it should reflect dark comedy or absurdist humor. The rubric specifically states 'good enrichment captures subtext and tonal nuance, not just plot,' and this output largely captures plot without the deeper tonal layer.",
              "tokensUsed": {
                "total": 1171,
                "prompt": 636,
                "completion": 535,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"INT. RUDDY & GREEN BUILDING - ELEVATOR\\\",\\\"location\\\":\\\"Ruddy & Green Building\\\",\\\"time_of_day\\\":\\\"Unspecified\\\",\\\"int_ext\\\":\\\"INT\\\",\\\"characters_present\\\":[\\\"ROSE\\\",\\\"MARINER\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"ROSE and MARINER are introduced in the elevator, both covered in blood, indicating recent violence or conflict.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"ROSE finds a bloody scrap and questions if it's a skull, hinting at a violent or gruesome event.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"MARINER's physical appearance and gear suggest he's a rugged, possibly combat-ready character, hinting at his background.\\\",\\\"confidence\\\":0.85},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"ROSE confronts MARINER about his distraction and tracking her with an AirTag, revealing tension and mistrust.\\\",\\\"confidence\\\":0.9}],\\\"tone_mood\\\":\\\"tense\\\",\\\"tone_shifts\\\":[\\\"neutral to tense\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "1f34fd60-612b-4169-b64e-78d6c133fc28",
        "latencyMs": 4446,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 0,
        "provider": {
          "id": "openai:gpt-4.1-nano",
          "label": "GPT-4.1 Nano"
        },
        "response": {
          "output": "{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"location\": \"Ruddy & Green Building\",\n  \"time_of_day\": \"Unspecified\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"ROSE and MARINER are introduced in the elevator, both covered in blood, indicating recent violence or conflict.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"ROSE finds a bloody scrap and questions if it's a skull, hinting at a violent or gruesome event.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"MARINER's physical appearance and gear suggest he's a rugged, possibly combat-ready character, hinting at his background.\",\n      \"confidence\": 0.85\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"ROSE confronts MARINER about his distraction and tracking her with an AirTag, revealing tension and mistrust.\",\n      \"confidence\": 0.9\n    }\n  ],\n  \"tone_mood\": \"tense\",\n  \"tone_shifts\": [\"neutral to tense\"]\n}",
          "tokenUsage": {
            "total": 1115,
            "prompt": 814,
            "completion": 301,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 4446,
          "finishReason": "stop",
          "cost": 0.00020180000000000003,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd28e98602c5d-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:05 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "4134",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=Qv3dRkpZ3zpiGFrXkN3WzgNyXxdZBP1LMwRVkpyKYwA-1771399861.5312057-1.0.1.1-dWFWtz9RL8IfFX4sndd_o9iogCAgh6RMTgX1cLg_O9sHqJnnaPTHXcM2OG5TfMXHduqYVbGI8IvYEwXA2KPfQoFJj8cf3QcQqx1rBiKXkVHl3PglORakgwW0ORA9XVcq; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:05 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "10000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "9999201",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "4ms",
                "x-request-id": "req_20a9a3c16096498a8748193137efb720"
              }
            }
          }
        },
        "score": 0.616,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd28e98602c5d-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:05 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "4134",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=Qv3dRkpZ3zpiGFrXkN3WzgNyXxdZBP1LMwRVkpyKYwA-1771399861.5312057-1.0.1.1-dWFWtz9RL8IfFX4sndd_o9iogCAgh6RMTgX1cLg_O9sHqJnnaPTHXcM2OG5TfMXHduqYVbGI8IvYEwXA2KPfQoFJj8cf3QcQqx1rBiKXkVHl3PglORakgwW0ORA9XVcq; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:05 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "10000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "9999201",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "4ms",
              "x-request-id": "req_20a9a3c16096498a8748193137efb720"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009672000000000001,
        "error": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense with underlying distrust' with shifts of 'tense to conflict'. The skull fragment is mentioned as a narrative beat, but the dark comedy element is largely missed. The muzak is not mentioned at all. The tone should capture the dark comedy/absurdist juxtaposition, not just tension. Partial fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, Mariner's introduction is noted as 'a large, stoic, heavily armed man with a distinctive appearance and gear.' Pass.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, this is captured in two beats - the revelation of the AirTag tracking and Rose's negative reaction as a breach of trust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak playing in the elevator while they're covered in blood/violence is a key tonal element that's completely absent. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are reasonably specific - skull fragment, Tim Hortons uniform, AirTag on phone. They seem grounded. However, they miss the comedic/absurdist elements. Partial pass.\n\nOverall: The enrichment captures the plot-level events well (character introductions, AirTag revelation, conflict) but significantly misses the tonal nuance. The dark comedy and tonal juxtaposition (muzak vs. violence, the absurdity of the situation) are key elements of the scene that are not reflected. The tone is described as merely 'tense' when it should capture the dark humor and absurdist contrasts. This is a competent but surface-level enrichment that misses subtext and tonal nuance.",
        "gradingResult": {
          "pass": false,
          "score": 0.6425000000000001,
          "reason": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense with underlying distrust' with shifts of 'tense to conflict'. The skull fragment is mentioned as a narrative beat, but the dark comedy element is largely missed. The muzak is not mentioned at all. The tone should capture the dark comedy/absurdist juxtaposition, not just tension. Partial fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, Mariner's introduction is noted as 'a large, stoic, heavily armed man with a distinctive appearance and gear.' Pass.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, this is captured in two beats - the revelation of the AirTag tracking and Rose's negative reaction as a breach of trust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak playing in the elevator while they're covered in blood/violence is a key tonal element that's completely absent. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are reasonably specific - skull fragment, Tim Hortons uniform, AirTag on phone. They seem grounded. However, they miss the comedic/absurdist elements. Partial pass.\n\nOverall: The enrichment captures the plot-level events well (character introductions, AirTag revelation, conflict) but significantly misses the tonal nuance. The dark comedy and tonal juxtaposition (muzak vs. violence, the absurdity of the situation) are key elements of the scene that are not reflected. The tone is described as merely 'tense' when it should capture the dark humor and absurdist contrasts. This is a competent but surface-level enrichment that misses subtext and tonal nuance.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1220,
            "prompt": 709,
            "completion": 511,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.785,
              "reason": "beat_quality=0.80 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'UNSPECIFIED', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": false,
              "score": 0.5,
              "reason": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR'. Pass.\n\n2. **Both Rose and Mariner present**: Yes, both are listed in characters_present. Pass.\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone is listed as 'tense with underlying distrust' with shifts of 'tense to conflict'. The skull fragment is mentioned as a narrative beat, but the dark comedy element is largely missed. The muzak is not mentioned at all. The tone should capture the dark comedy/absurdist juxtaposition, not just tension. Partial fail.\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, Mariner's introduction is noted as 'a large, stoic, heavily armed man with a distinctive appearance and gear.' Pass.\n\n5. **AirTag revelation as conflict/trust beat**: Yes, this is captured in two beats - the revelation of the AirTag tracking and Rose's negative reaction as a breach of trust. Pass.\n\n6. **Tonal juxtaposition (muzak vs violence)**: Not captured at all. The muzak playing in the elevator while they're covered in blood/violence is a key tonal element that's completely absent. Fail.\n\n7. **Narrative beats specific and grounded in text**: The beats are reasonably specific - skull fragment, Tim Hortons uniform, AirTag on phone. They seem grounded. However, they miss the comedic/absurdist elements. Partial pass.\n\nOverall: The enrichment captures the plot-level events well (character introductions, AirTag revelation, conflict) but significantly misses the tonal nuance. The dark comedy and tonal juxtaposition (muzak vs. violence, the absurdity of the situation) are key elements of the scene that are not reflected. The tone is described as merely 'tense' when it should capture the dark humor and absurdist contrasts. This is a competent but surface-level enrichment that misses subtext and tonal nuance.",
              "tokensUsed": {
                "total": 1220,
                "prompt": 709,
                "completion": 511,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"INT. RUDDY & GREEN BUILDING - ELEVATOR\\\",\\\"location\\\":\\\"Ruddy & Green Building - Elevator\\\",\\\"time_of_day\\\":\\\"UNSPECIFIED\\\",\\\"int_ext\\\":\\\"INT\\\",\\\"characters_present\\\":[\\\"ROSE\\\",\\\"MARINER\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Rose is introduced as a mid-30s woman in a Tim Hortons uniform, visibly distressed and bloodied, establishing her current vulnerable state.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Mariner is introduced as a large, stoic, heavily armed man with a distinctive appearance and gear, suggesting a protector or warrior role.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"Rose discovers a bloody skull fragment, indicating a violent or dangerous event has occurred.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"Rose confronts Mariner about his failure to pick her up, expressing anger and frustration.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"Mariner reveals he was tracking the car that kidnapped Rose using an AirTag he secretly placed on her phone.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"Rose reacts negatively to the revelation that Mariner secretly tracked her, indicating a breach of trust.\\\",\\\"confidence\\\":1}],\\\"tone_mood\\\":\\\"tense with underlying distrust\\\",\\\"tone_shifts\\\":[\\\"tense to conflict\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "17023c80-7012-4547-9e9f-be2956dbcdc5",
        "latencyMs": 5524,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 1,
        "provider": {
          "id": "openai:gpt-4.1-mini",
          "label": "GPT-4.1 Mini"
        },
        "response": {
          "output": "{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"location\": \"Ruddy & Green Building - Elevator\",\n  \"time_of_day\": \"UNSPECIFIED\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced as a mid-30s woman in a Tim Hortons uniform, visibly distressed and bloodied, establishing her current vulnerable state.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Mariner is introduced as a large, stoic, heavily armed man with a distinctive appearance and gear, suggesting a protector or warrior role.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Rose discovers a bloody skull fragment, indicating a violent or dangerous event has occurred.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner about his failure to pick her up, expressing anger and frustration.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner reveals he was tracking the car that kidnapped Rose using an AirTag he secretly placed on her phone.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose reacts negatively to the revelation that Mariner secretly tracked her, indicating a breach of trust.\",\n      \"confidence\": 1.0\n    }\n  ],\n  \"tone_mood\": \"tense with underlying distrust\",\n  \"tone_shifts\": [\"tense to conflict\"]\n}",
          "tokenUsage": {
            "total": 1215,
            "prompt": 814,
            "completion": 401,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 5524,
          "finishReason": "stop",
          "cost": 0.0009672000000000001,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd28e7fec2554-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:06 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "5165",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=fUjJaECBMFZr0Wx6i5gamH7bgwF5fYPkXaH.zXNlwI0-1771399861.517944-1.0.1.1-oE1_iW6xNAYt8pGqmyHEOHq7urlespEaC7D508h5EpQn_PjduWRlOxPXwQySR7SUJ5nonyVGmTvWYOjQ6_T5glBkfeuNpRPRfi9t4anSkfTylye3gIfpw57sVOJJ4.n7; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:06 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "10000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "9999202",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "4ms",
                "x-request-id": "req_84fae8085e5f476c9683fa55ca3ace55"
              }
            }
          }
        },
        "score": 0.6425000000000001,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd28e7fec2554-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:06 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "5165",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=fUjJaECBMFZr0Wx6i5gamH7bgwF5fYPkXaH.zXNlwI0-1771399861.517944-1.0.1.1-oE1_iW6xNAYt8pGqmyHEOHq7urlespEaC7D508h5EpQn_PjduWRlOxPXwQySR7SUJ5nonyVGmTvWYOjQ6_T5glBkfeuNpRPRfi9t4anSkfTylye3gIfpw57sVOJJ4.n7; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:06 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "10000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "9999202",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "4ms",
              "x-request-id": "req_84fae8085e5f476c9683fa55ca3ace55"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.00514,
        "gradingResult": {
          "pass": true,
          "score": 0.8875,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1074,
            "prompt": 758,
            "completion": 316,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.825,
              "reason": "beat_quality=1.00 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'DAY', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.95,
              "reason": "The output excels across all seven criteria: 1) Correctly identifies INT. location as Ruddy & Green Building - Elevator. 2) Both Rose and Mariner are identified as present. 3) Dark comedy tone is captured explicitly, with mention of the juxtaposition of violent aftermath with elevator muzak and deadpan reactions. 4) Character introductions are identified for both Rose (disheveled, Tim Hortons uniform) and Mariner (stoic, nautical gear, blood-covered), capturing costume/appearance details. 5) The AirTag revelation is explicitly noted as both a revelation beat and a conflict/trust beat, with Rose's reaction showing discomfort with his invasive methods. 6) Tonal juxtaposition (muzak vs violence) is specifically called out in the comic_relief beat and in the tone_shifts array. 7) Narrative beats are specific and grounded in textual details (Tim Hortons uniform, AirTag, bloody scrap, elevator muzak), not generic summaries. The enrichment also captures subtext well — noting 'deeper relational issues' and Rose's assertiveness as character development, and identifying multiple tonal shifts. The confidence scores are appropriately calibrated. This is a thorough, nuanced enrichment that goes beyond surface plot to capture tone, subtext, and character dynamics.",
              "tokensUsed": {
                "total": 1074,
                "prompt": 758,
                "completion": 316,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\\\",\\\"location\\\":\\\"Ruddy & Green Building - Elevator\\\",\\\"time_of_day\\\":\\\"DAY\\\",\\\"int_ext\\\":\\\"INT\\\",\\\"characters_present\\\":[\\\"ROSE\\\",\\\"MARINER\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Rose is introduced in a disheveled, bloodied state, wearing a Tim Hortons uniform, immediately establishing her as the protagonist in distress.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Mariner is introduced as a stoic, imposing figure, covered in blood and outfitted with nautical gear, suggesting a rugged, action-oriented background.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"comic_relief\\\",\\\"description\\\":\\\"The juxtaposition of violent aftermath with elevator muzak and Rose's deadpan reaction to a bloody scrap provides darkly comic relief.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"Mariner reveals he was tracking Rose via an AirTag he secretly placed on her phone, surprising and upsetting her.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"Rose confronts Mariner about his failure to pick her up and his invasive tracking, escalating tension between them.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Rose's reaction to Mariner's actions shows her assertiveness and discomfort with his methods, hinting at deeper relational issues.\\\",\\\"confidence\\\":0.95}],\\\"tone_mood\\\":\\\"dark comedy with underlying tension\\\",\\\"tone_shifts\\\":[\\\"dark comedy to tension\\\",\\\"tension to comic relief\\\",\\\"comic relief to conflict\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "6d627e7f-184d-480e-9bc2-0d11449e2613",
        "latencyMs": 6563,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 2,
        "provider": {
          "id": "openai:gpt-4.1",
          "label": "GPT-4.1"
        },
        "response": {
          "output": "{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\",\n  \"location\": \"Ruddy & Green Building - Elevator\",\n  \"time_of_day\": \"DAY\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced in a disheveled, bloodied state, wearing a Tim Hortons uniform, immediately establishing her as the protagonist in distress.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Mariner is introduced as a stoic, imposing figure, covered in blood and outfitted with nautical gear, suggesting a rugged, action-oriented background.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"The juxtaposition of violent aftermath with elevator muzak and Rose's deadpan reaction to a bloody scrap provides darkly comic relief.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner reveals he was tracking Rose via an AirTag he secretly placed on her phone, surprising and upsetting her.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner about his failure to pick her up and his invasive tracking, escalating tension between them.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Rose's reaction to Mariner's actions shows her assertiveness and discomfort with his methods, hinting at deeper relational issues.\",\n      \"confidence\": 0.95\n    }\n  ],\n  \"tone_mood\": \"dark comedy with underlying tension\",\n  \"tone_shifts\": [\"dark comedy to tension\", \"tension to comic relief\", \"comic relief to conflict\"]\n}",
          "tokenUsage": {
            "total": 1253,
            "prompt": 814,
            "completion": 439,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 6563,
          "finishReason": "stop",
          "cost": 0.00514,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd28e9fbe1812-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:07 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "6172",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=SorDmEe.Gu7YjtGpxKnuO9TACri8x76j_qffL5gOlho-1771399861.531847-1.0.1.1-3taHnz01ExZLhs8i6mQES4GlB6ZvJdqyQZpTM9dASxlg_tExYZOf66ESi.j4uoe3xf.NS7BjekIxWyNU8E7w00Td5UhSZRqYExjR_3a1U0codxJS33NJIVyz8x4hQp56; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:07 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "2000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "1999202",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "23ms",
                "x-request-id": "req_d475778deb41486289c6bedacadf3ea0"
              }
            }
          }
        },
        "score": 0.8875,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd28e9fbe1812-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:07 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "6172",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=SorDmEe.Gu7YjtGpxKnuO9TACri8x76j_qffL5gOlho-1771399861.531847-1.0.1.1-3taHnz01ExZLhs8i6mQES4GlB6ZvJdqyQZpTM9dASxlg_tExYZOf66ESi.j4uoe3xf.NS7BjekIxWyNU8E7w00Td5UhSZRqYExjR_3a1U0codxJS33NJIVyz8x4hQp56; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:07 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "2000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "1999202",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "23ms",
              "x-request-id": "req_d475778deb41486289c6bedacadf3ea0"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0031260000000000003,
        "gradingResult": {
          "pass": true,
          "score": 0.8,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1304,
            "prompt": 827,
            "completion": 477,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.85,
              "reason": "beat_quality=0.80 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | JSON extracted from code block | Time: got 'DAY', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.75,
              "reason": "Let me evaluate against each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as INT. with location 'Ruddy & Green Building - Elevator'. ✓\n\n2. **Both Rose and Mariner present**: Yes, both listed in characters_present. ✓\n\n3. **Dark comedy tone (skull fragment, muzak contrast)**: The tone_mood is correctly identified as 'dark comedy' and the skull fragment is mentioned in the narrative beats. However, the muzak is not explicitly mentioned. Partial ✓\n\n4. **Character introduction beat (Mariner's costume description)**: Yes, there's a specific beat about Mariner's introduction via title card with detailed description of his nautical gear, weapons, and blood-covered appearance. ✓\n\n5. **AirTag revelation as conflict/trust beat**: Yes, there's a dedicated revelation beat about the AirTag and a character_development beat about controlling behavior masked as protective concern. This captures subtext well. ✓\n\n6. **Tonal juxtaposition (muzak vs violence)**: The tone_shifts mention 'conflict to absurdist humor' which partially captures this, but the specific muzak vs. violence juxtaposition is not called out. The output misses this specific and important tonal element. ✗\n\n7. **Narrative beats specific and grounded in text**: The beats are quite specific - mentioning Tim Hortons uniform, skull fragment, AirTag, bloodied oar, title card introduction. They feel grounded in actual script details. ✓\n\nThe output does a good job capturing subtext (controlling behavior masked as concern) and most tonal elements. The main weakness is missing the muzak/violence juxtaposition, which is a key tonal device. The beats are well-structured and specific. Overall this is a solid enrichment that captures most of the important elements with good subtext awareness, but misses one notable tonal nuance.",
              "tokensUsed": {
                "total": 1304,
                "prompt": 827,
                "completion": 477,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"INT. RUDDY & GREEN BUILDING - ELEVATOR\\\",\\n  \\\"location\\\": \\\"Ruddy & Green Building - Elevator\\\",\\n  \\\"time_of_day\\\": \\\"DAY\\\",\\n  \\\"int_ext\\\": \\\"INT\\\",\\n  \\\"characters_present\\\": [\\n    \\\"Rose\\\",\\n    \\\"Mariner\\\"\\n  ],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Rose is introduced as a disheveled Tim Hortons employee covered in blood, discovering what appears to be a skull fragment in the elevator.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Mariner is introduced via title card as a heavily armed, imposing figure dressed in fishing/nautical gear, covered in blood and holding a bloodied oar.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"conflict\\\",\\n      \\\"description\\\": \\\"Rose confronts Mariner about failing to pick her up from work as promised, escalating into an argument about his absence.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"revelation\\\",\\n      \\\"description\\\": \\\"Mariner reveals he was tracking Rose through an AirTag he secretly placed on her phone, which Rose finds invasive and upsetting.\\\",\\n      \\\"confidence\\\": 0.92\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"The exchange reveals tension in their relationship and Mariner's controlling behavior masked as protective concern.\\\",\\n      \\\"confidence\\\": 0.85\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"dark comedy\\\",\\n  \\\"tone_shifts\\\": [\\n    \\\"dark comedy to conflict\\\",\\n    \\\"conflict to absurdist humor\\\"\\n  ]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "f800df04-5084-4178-adb7-75dd699843b9",
        "latencyMs": 3386,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 3,
        "provider": {
          "id": "anthropic:messages:claude-haiku-4-5-20251001",
          "label": "Claude Haiku 4.5"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"location\": \"Ruddy & Green Building - Elevator\",\n  \"time_of_day\": \"DAY\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\n    \"Rose\",\n    \"Mariner\"\n  ],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced as a disheveled Tim Hortons employee covered in blood, discovering what appears to be a skull fragment in the elevator.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Mariner is introduced via title card as a heavily armed, imposing figure dressed in fishing/nautical gear, covered in blood and holding a bloodied oar.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner about failing to pick her up from work as promised, escalating into an argument about his absence.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner reveals he was tracking Rose through an AirTag he secretly placed on her phone, which Rose finds invasive and upsetting.\",\n      \"confidence\": 0.92\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"The exchange reveals tension in their relationship and Mariner's controlling behavior masked as protective concern.\",\n      \"confidence\": 0.85\n    }\n  ],\n  \"tone_mood\": \"dark comedy\",\n  \"tone_shifts\": [\n    \"dark comedy to conflict\",\n    \"conflict to absurdist humor\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 1354,
            "prompt": 911,
            "completion": 443
          },
          "finishReason": "stop",
          "cost": 0.0031260000000000003
        },
        "score": 0.8,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.009588,
        "gradingResult": {
          "pass": true,
          "score": 0.785,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1278,
            "prompt": 841,
            "completion": 437,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.79,
              "reason": "beat_quality=0.88 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | JSON extracted from code block | Time: got 'DAY', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.78,
              "reason": "Evaluating against the rubric criteria:\n\n1. **Interior location (elevator/building)**: Correctly identified as INT. RUDDY & GREEN BUILDING - ELEVATOR. ✅\n2. **Both Rose and Mariner present**: Yes, both identified in characters_present. ✅\n3. **Dark comedy tone**: Correctly identified as 'dark comedy' and mentions skull fragment. ✅\n4. **Character introduction beat (Mariner's costume)**: Yes, captured with high confidence, mentioning nautical-themed costume, pro-wrestler build, and bloody oar. ✅\n5. **AirTag revelation as conflict/trust beat**: Yes, captured both as a 'revelation' beat and a subsequent 'conflict' beat about consent/trust. ✅\n6. **Tonal juxtaposition (muzak vs violence)**: This is partially missed. The tone_shifts mention 'post-action exhaustion to comic relief' which could implicitly reference the muzak contrast, but the muzak is never explicitly mentioned anywhere in the output. The rubric specifically asks about the muzak vs violence juxtaposition, which is a key element of the dark comedy tone. This is a notable omission. ❌\n7. **Narrative beats specific and grounded in text**: The beats are quite specific - mentioning Tim Hortons uniform, skull on elevator floor, AirTag on phone, bloody oar. These are grounded in textual details. ✅\n\nThe enrichment does a good job capturing most elements including subtext (the trust/consent issue with the AirTag) and tonal nuance (dark comedy). However, it misses the specific muzak juxtaposition which is a key tonal device. The narrative beats are well-structured and specific. Overall this is a solid enrichment with one notable gap.",
              "tokensUsed": {
                "total": 1278,
                "prompt": 841,
                "completion": 437,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\\\",\\n  \\\"location\\\": \\\"RUDDY & GREEN BUILDING - ELEVATOR\\\",\\n  \\\"time_of_day\\\": \\\"DAY\\\",\\n  \\\"int_ext\\\": \\\"INT\\\",\\n  \\\"characters_present\\\": [\\\"ROSE\\\", \\\"MARINER\\\"],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Rose is introduced in a disheveled, bloodied state wearing a Tim Hortons uniform, establishing she's been through a violent ordeal. She discovers a piece of skull on the elevator floor.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"The Mariner is introduced with a full title card, revealing a heavily armed, pro-wrestler-built vigilante with distinctive nautical-themed costume and weaponry including a bloody oar.\\\",\\n      \\\"confidence\\\": 1.0\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"conflict\\\",\\n      \\\"description\\\": \\\"Rose confronts Mariner about not being there when she was grabbed, accusing him of being distracted when he was supposed to protect her.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"revelation\\\",\\n      \\\"description\\\": \\\"Mariner reveals he was tracking Rose's kidnappers through an AirTag he secretly placed on her phone, which immediately creates new tension.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"conflict\\\",\\n      \\\"description\\\": \\\"Rose reacts with anger upon learning Mariner has been tracking her without her knowledge or consent.\\\",\\n      \\\"confidence\\\": 0.9\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"dark comedy\\\",\\n  \\\"tone_shifts\\\": [\\\"post-action exhaustion to comic relief\\\", \\\"comic relief to interpersonal conflict\\\"]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "d6514528-bf52-40d6-a57c-e32eace15c62",
        "latencyMs": 8678,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 4,
        "provider": {
          "id": "anthropic:messages:claude-sonnet-4-5-20250929",
          "label": "Claude Sonnet 4.5"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\",\n  \"location\": \"RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"time_of_day\": \"DAY\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced in a disheveled, bloodied state wearing a Tim Hortons uniform, establishing she's been through a violent ordeal. She discovers a piece of skull on the elevator floor.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"The Mariner is introduced with a full title card, revealing a heavily armed, pro-wrestler-built vigilante with distinctive nautical-themed costume and weaponry including a bloody oar.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner about not being there when she was grabbed, accusing him of being distracted when he was supposed to protect her.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner reveals he was tracking Rose's kidnappers through an AirTag he secretly placed on her phone, which immediately creates new tension.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose reacts with anger upon learning Mariner has been tracking her without her knowledge or consent.\",\n      \"confidence\": 0.9\n    }\n  ],\n  \"tone_mood\": \"dark comedy\",\n  \"tone_shifts\": [\"post-action exhaustion to comic relief\", \"comic relief to interpersonal conflict\"]\n}\n```",
          "tokenUsage": {
            "total": 1368,
            "prompt": 911,
            "completion": 457
          },
          "finishReason": "stop",
          "cost": 0.009588
        },
        "score": 0.785,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 0.8875,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1203,
            "prompt": 876,
            "completion": 327,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.825,
              "reason": "beat_quality=1.00 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'UNKNOWN', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.95,
              "reason": "The output excels across all seven criteria: 1) Correctly identifies INT. RUDDY & GREEN BUILDING - ELEVATOR as the interior location. 2) Both Rose and Mariner are identified as present. 3) Dark comedy tone is explicitly identified and well-articulated, with specific references to the skull fragment, muzak, and mundane workplace grievances. 4) Character introduction beats are captured for both Rose (disheveled Tim Hortons worker) and Mariner (heavily armed maritime-themed hero with costume/weapon details), with the contrast to the mundane elevator setting noted. 5) The AirTag revelation is identified as a distinct beat with nuanced analysis about trust, autonomy, and the shift from negligence to surveillance. 6) Tonal juxtaposition is explicitly recognized both in the comic_relief beat (UB40 muzak, bloody oar, skull fragment, workplace grievances) and in the tone_shifts array. 7) Narrative beats are specific and grounded in textual details rather than generic summaries, with subtext about Rose's independence, the complicated protective dynamic, and genre-awareness all captured. The enrichment goes beyond plot summary to capture subtext (Rose's autonomy, the reframing of Mariner's absence) and tonal nuance (sustained dark comedy, specific tonal shifts). Confidence scores are reasonable. This is a high-quality enrichment.",
              "tokensUsed": {
                "total": 1203,
                "prompt": 876,
                "completion": 327,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"INT. RUDDY & GREEN BUILDING - ELEVATOR\\\",\\\"location\\\":\\\"RUDDY & GREEN BUILDING - ELEVATOR\\\",\\\"time_of_day\\\":\\\"UNKNOWN\\\",\\\"int_ext\\\":\\\"INT\\\",\\\"characters_present\\\":[\\\"ROSE\\\",\\\"MARINER\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Rose is introduced as a disheveled Tim Hortons worker covered in blood, establishing her as an ordinary person caught in extraordinary violence. Her casual disgust at finding a skull fragment immediately signals the scene's dark comedic tone.\\\",\\\"confidence\\\":0.97},{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"The Mariner is introduced via title card as a larger-than-life, heavily armed maritime-themed hero whose stoic, blood-soaked appearance contrasts with the mundane elevator setting. His costume and weapon design establish him as a distinctive, genre-aware superhero figure.\\\",\\\"confidence\\\":0.97},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"Rose confronts Mariner for failing to pick her up from work, revealing a pre-existing protective relationship and her frustration at being put in danger. This establishes interpersonal tension beneath the post-action calm.\\\",\\\"confidence\\\":0.93},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"Mariner reveals he had secretly placed an AirTag on Rose's phone, reframing his absence as covert surveillance rather than negligence. This shifts the conflict from dereliction of duty to a violation of trust and autonomy.\\\",\\\"confidence\\\":0.95},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Rose's escalating anger at being AirTagged reveals her strong sense of independence and her complicated dynamic with Mariner, suggesting she is not simply a passive person under his protection.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"comic_relief\\\",\\\"description\\\":\\\"The juxtaposition of UB40 muzak, a bloody oar, a skull fragment, and mundane workplace grievances in an elevator creates sustained dark comedy throughout the scene.\\\",\\\"confidence\\\":0.96}],\\\"tone_mood\\\":\\\"dark comedy\\\",\\\"tone_shifts\\\":[\\\"visceral action aftermath to deadpan comic relief\\\",\\\"comic relief to interpersonal conflict\\\",\\\"interpersonal conflict to indignant revelation\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "50e98049-e681-410d-93d5-6efa8a6e6af6",
        "latencyMs": 11012,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 5,
        "provider": {
          "id": "anthropic:messages:claude-sonnet-4-6",
          "label": "Claude Sonnet 4.6"
        },
        "response": {
          "output": "{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"location\": \"RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"time_of_day\": \"UNKNOWN\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced as a disheveled Tim Hortons worker covered in blood, establishing her as an ordinary person caught in extraordinary violence. Her casual disgust at finding a skull fragment immediately signals the scene's dark comedic tone.\",\n      \"confidence\": 0.97\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"The Mariner is introduced via title card as a larger-than-life, heavily armed maritime-themed hero whose stoic, blood-soaked appearance contrasts with the mundane elevator setting. His costume and weapon design establish him as a distinctive, genre-aware superhero figure.\",\n      \"confidence\": 0.97\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner for failing to pick her up from work, revealing a pre-existing protective relationship and her frustration at being put in danger. This establishes interpersonal tension beneath the post-action calm.\",\n      \"confidence\": 0.93\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner reveals he had secretly placed an AirTag on Rose's phone, reframing his absence as covert surveillance rather than negligence. This shifts the conflict from dereliction of duty to a violation of trust and autonomy.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Rose's escalating anger at being AirTagged reveals her strong sense of independence and her complicated dynamic with Mariner, suggesting she is not simply a passive person under his protection.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"The juxtaposition of UB40 muzak, a bloody oar, a skull fragment, and mundane workplace grievances in an elevator creates sustained dark comedy throughout the scene.\",\n      \"confidence\": 0.96\n    }\n  ],\n  \"tone_mood\": \"dark comedy\",\n  \"tone_shifts\": [\n    \"visceral action aftermath to deadpan comic relief\",\n    \"comic relief to interpersonal conflict\",\n    \"interpersonal conflict to indignant revelation\"\n  ]\n}",
          "tokenUsage": {
            "total": 1536,
            "prompt": 911,
            "completion": 625
          },
          "finishReason": "stop"
        },
        "score": 0.8875,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.00839475,
        "gradingResult": {
          "pass": true,
          "score": 0.88,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1128,
            "prompt": 813,
            "completion": 315,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.81,
              "reason": "beat_quality=0.93 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'DAY', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.95,
              "reason": "The output excels across all seven criteria: (1) Correctly identifies INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY. (2) Both Rose and Mariner are listed as characters present. (3) Dark comedy tone is explicitly captured, with the skull fragment and muzak contrast noted as a specific beat ('comic_relief'). (4) Mariner's character introduction beat is identified with reference to his imposing costuming, blood-dripping oar, and title card. (5) The AirTag revelation is captured as both a 'revelation' beat and tied to trust issues. (6) The tonal juxtaposition of calm elevator muzak vs. gore is explicitly noted. (7) Narrative beats are specific and grounded in textual details (Tim Hortons uniform, bloody scrap/skull, AirTag tracking, interpersonal confrontation). The enrichment goes beyond plot summary to capture subtext: Rose's boundaries around privacy, the complicated trust dynamic, and the grim-comedy-to-conflict tonal shifts. Confidence scores are reasonable. The only minor quibble is that Rose's beat could more explicitly note her Tim Hortons uniform as world-building detail, but this is captured in the description. Overall, this is high-quality enrichment that captures both surface events and underlying tonal/thematic nuance.",
              "tokensUsed": {
                "total": 1128,
                "prompt": 813,
                "completion": 315,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\\\",\\\"location\\\":\\\"RUDDY & GREEN BUILDING - ELEVATOR\\\",\\\"time_of_day\\\":\\\"DAY\\\",\\\"int_ext\\\":\\\"INT\\\",\\\"characters_present\\\":[\\\"ROSE\\\",\\\"MARINER\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Rose is revealed in disarray—panting, in a Tim Hortons uniform, with blood on her face—implying a recent violent incident and her immediate survival mode.\\\",\\\"confidence\\\":0.86},{\\\"beat_type\\\":\\\"comic_relief\\\",\\\"description\\\":\\\"The calm elevator muzak contrasts the gore as Rose picks up a bloody scrap and asks, horrified, if it’s skull, landing as grim humor.\\\",\\\"confidence\\\":0.82},{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Mariner is introduced via a title card and detailed, imposing costuming; he’s heavily bloodied and armed with a blood-dripping oar, signaling a larger-than-life, violent competence.\\\",\\\"confidence\\\":0.93},{\\\"beat_type\\\":\\\"conflict\\\",\\\"description\\\":\\\"Rose confronts Mariner for failing to pick her up when she was grabbed, escalating their interpersonal tension despite their shared situation.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"revelation\\\",\\\"description\\\":\\\"Mariner admits he planted an AirTag to track Rose’s phone and followed the abductor’s car, reframing his absence as premeditated surveillance and sparking a new trust issue.\\\",\\\"confidence\\\":0.92},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Rose’s anger pivots from abandonment to violation of privacy, revealing her boundaries and setting up a complicated dynamic with Mariner.\\\",\\\"confidence\\\":0.84}],\\\"tone_mood\\\":\\\"grim dark comedy with underlying tension\\\",\\\"tone_shifts\\\":[\\\"grim to darkly comic\\\",\\\"dark comedy to interpersonal conflict\\\",\\\"conflict to uneasy revelation\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "0179d00d-fb8a-42b0-a412-188e9e555bae",
        "latencyMs": 7953,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 6,
        "provider": {
          "id": "openai:gpt-5.2",
          "label": "GPT-5.2"
        },
        "response": {
          "output": "{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\",\n  \"location\": \"RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"time_of_day\": \"DAY\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\n    \"ROSE\",\n    \"MARINER\"\n  ],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is revealed in disarray—panting, in a Tim Hortons uniform, with blood on her face—implying a recent violent incident and her immediate survival mode.\",\n      \"confidence\": 0.86\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"The calm elevator muzak contrasts the gore as Rose picks up a bloody scrap and asks, horrified, if it’s skull, landing as grim humor.\",\n      \"confidence\": 0.82\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Mariner is introduced via a title card and detailed, imposing costuming; he’s heavily bloodied and armed with a blood-dripping oar, signaling a larger-than-life, violent competence.\",\n      \"confidence\": 0.93\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner for failing to pick her up when she was grabbed, escalating their interpersonal tension despite their shared situation.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner admits he planted an AirTag to track Rose’s phone and followed the abductor’s car, reframing his absence as premeditated surveillance and sparking a new trust issue.\",\n      \"confidence\": 0.92\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Rose’s anger pivots from abandonment to violation of privacy, revealing her boundaries and setting up a complicated dynamic with Mariner.\",\n      \"confidence\": 0.84\n    }\n  ],\n  \"tone_mood\": \"grim dark comedy with underlying tension\",\n  \"tone_shifts\": [\n    \"grim to darkly comic\",\n    \"dark comedy to interpersonal conflict\",\n    \"conflict to uneasy revelation\"\n  ]\n}",
          "tokenUsage": {
            "total": 1311,
            "prompt": 813,
            "completion": 498,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 7953,
          "finishReason": "stop",
          "cost": 0.00839475,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd33e4fca2c5d-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:37 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "7832",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=jZeUT9urtWxNjWeg9FXrAF8Rn8klfWPnyvykL0BlD8s-1771399889.6422765-1.0.1.1-.s669ysfHNqhhKj7T8qR2wnVe7z9z0ebceontUBmkE9.FcR0f6C230FM.kQEe3pxWHa1ga3.0mxr2E7WoFIqsYILVA9xIAtHYi3g9ypkYHiQ3cjNZLIGBIQjhBEv2nkv; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:37 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "4000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "3999202",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "11ms",
                "x-request-id": "req_2d88600df46741fe9fff6b2ce0fc94ed"
              }
            }
          }
        },
        "score": 0.88,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd33e4fca2c5d-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:37 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "7832",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=jZeUT9urtWxNjWeg9FXrAF8Rn8klfWPnyvykL0BlD8s-1771399889.6422765-1.0.1.1-.s669ysfHNqhhKj7T8qR2wnVe7z9z0ebceontUBmkE9.FcR0f6C230FM.kQEe3pxWHa1ga3.0mxr2E7WoFIqsYILVA9xIAtHYi3g9ypkYHiQ3cjNZLIGBIQjhBEv2nkv; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:37 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "4000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "3999202",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "11ms",
              "x-request-id": "req_2d88600df46741fe9fff6b2ce0fc94ed"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.02048,
        "gradingResult": {
          "pass": true,
          "score": 0.7975,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1498,
            "prompt": 1021,
            "completion": 477,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.815,
              "reason": "beat_quality=1.00 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | JSON extracted from code block | Time: got 'DAY', expected 'NIGHT'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
              },
              "pass": true,
              "score": 0.78,
              "reason": "Let me evaluate each criterion:\n\n1. **Interior location (elevator/building)**: Yes, correctly identified as 'INT. RUDDY & GREEN BUILDING - ELEVATOR' with proper int_ext as 'INT'. ✓\n\n2. **Both Rose and Mariner present**: Yes, both listed in characters_present. ✓\n\n3. **Dark comedy tone**: Yes, identified as 'dark comedy with domestic bickering' and includes the skull fragment beat as comic relief. ✓\n\n4. **Character introduction beat (Mariner's costume)**: Yes, detailed description of Mariner's costume including nautical-themed gear, fishing net cape, shell bandolier, anchor bracers, and bloody oar. ✓\n\n5. **AirTag revelation as conflict/trust beat**: Yes, captured both as a 'revelation' beat and as 'foreshadowing' about trust issues. ✓\n\n6. **Tonal juxtaposition (muzak vs violence)**: This is notably missing. The rubric specifically asks about the muzak contrast, which is a key tonal element of the scene — elevator muzak playing against the backdrop of gore and violence. The tone_shifts mention transitions but don't capture this specific juxtaposition. The muzak is not mentioned anywhere in the output. ✗\n\n7. **Narrative beats specific and grounded in text**: Yes, the beats are specific — referencing the skull piece, the Tim Hortons uniform, the AirTag, the costume details. They are well-grounded. ✓\n\nThe output is strong overall with good subtext analysis (the relationship dynamics, privacy violation implications, foreshadowing). However, it misses the muzak vs. violence tonal juxtaposition, which is a significant element of the scene's dark comedy and tonal nuance. The enrichment captures most subtext well but missing this specific contrast is a notable gap given the rubric's emphasis on tonal nuance.",
              "tokensUsed": {
                "total": 1498,
                "prompt": 1021,
                "completion": 477,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\\\",\\n  \\\"location\\\": \\\"RUDDY & GREEN BUILDING - ELEVATOR\\\",\\n  \\\"time_of_day\\\": \\\"DAY\\\",\\n  \\\"int_ext\\\": \\\"INT\\\",\\n  \\\"characters_present\\\": [\\\"ROSE\\\", \\\"MARINER\\\"],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Rose is introduced as a mid-30s Tim Hortons worker, disheveled and blood-spattered, catching her breath in an elevator after a violent encounter.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"The Mariner is introduced via a full-screen title card as a massive, costumed vigilante/superhero figure wielding a bloody oar, dressed in nautical-themed gear including a fishing net cape, shell bandolier, and anchor bracers.\\\",\\n      \\\"confidence\\\": 0.98\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"comic_relief\\\",\\n      \\\"description\\\": \\\"Rose discovers a bloody piece of skull in the elevator and reacts with casual disgust, establishing a darkly humorous tone amid the gore.\\\",\\n      \\\"confidence\\\": 0.92\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"conflict\\\",\\n      \\\"description\\\": \\\"Rose confronts Mariner for failing to pick her up from work, which led to her being grabbed, revealing tension in their relationship and his unreliability.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"revelation\\\",\\n      \\\"description\\\": \\\"Mariner admits he tracked Rose via an AirTag he secretly placed on her phone, shifting her anger from his absence to a violation of her privacy.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"The dynamic between Rose and Mariner is established — she is grounded and exasperated, he is well-meaning but overstepping, suggesting a complicated personal relationship beneath the superhero action.\\\",\\n      \\\"confidence\\\": 0.88\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"foreshadowing\\\",\\n      \\\"description\\\": \\\"The AirTag revelation hints at deeper trust issues and boundary problems in their relationship that will likely become a recurring source of conflict.\\\",\\n      \\\"confidence\\\": 0.7\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"dark comedy with domestic bickering\\\",\\n  \\\"tone_shifts\\\": [\\n    \\\"gory aftermath to comic relief\\\",\\n    \\\"comic relief to domestic conflict\\\",\\n    \\\"domestic conflict to privacy violation outrage\\\"\\n  ]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for an elevator scene from \\\"The Mariner.\\\"\\n\\nThe scene takes place inside an elevator in a building. Rose and Mariner\\nare escaping after a violent rescue. Key elements:\\n\\n1. Does it correctly identify the interior location (elevator/building)?\\n2. Does it identify both Rose and Mariner as present?\\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\\n4. Does it identify the character introduction beat (Mariner's costume description)?\\n5. Does it note the AirTag revelation as a conflict/trust beat?\\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\\n7. Are narrative beats specific and grounded in the text?\\n\\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "a9db8e15-286f-407e-b0ab-1751d2a8f623",
        "latencyMs": 12377,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nINT. RUDDY & GREEN BUILDING - ELEVATOR\n\nUB40's \"I Can't Help Falling in Love With You\" muzak.\n\nROSE (mid-30s) leans against the elevator wall, panting. She's wearing a Tim Hortons uniform, her hair is a mess, and there's blood spattered on her face.\n\nShe looks right, pants a few more times, then squints in disgust. She gingerly picks up a bloody scrap of something with hair on it. She snorts and drops it.\n\nROSE\nIs that skull??\n\nNext to her is Mariner, also panting, covered in far more blood. His face is broad, stoic, and frowning. He has gray-blue eyes and a thick, curly, beard barely streaked with gray. He wears a red knit cap and a small mask.\n\nFULL-SCREEN SUPERIMPOSED TITLE CARD: \"THE MARINER\"\n\nHe blinks a few times as a drop of blood falls from his eyebrow. He looks toward her, then spits out some blood.\n\nMARINER\nYeaaaaah...\n\nHe's built like a pro-wrestler. Moss green SWEATER stretched over his huge frame, sleeves rolled showing heavy leather BRACERS adorned with anchors. His inner forearm has a classic heart-and-arrow TATTOO with \"Dad\" in the centre. Across his chest is a BANDOLIER of bright red 12-gauge shells, FISH HOOKS hanging from the bottom edge. Heavy rubberized BOOTS go past his knees. A CAPE of heavy FISHING NET edged with WEIGHTS hangs from his shoulders.\n\nHe holds a STOUT WOODEN OAR in both hands, edged with METAL and dripping with BLOOD.\n\nROSE\nWhere were you when they grabbed me? You were supposed to pick me up at work!\n\nMARINER\nYeah, about that, I got a little... distracted.\n\nROSE\nDistracted. You got DISTRACTED?!\n\nMARINER\nI was also... tracking the car... that grabbed you... through the AirTag... I put on your phone.\n\nRose stops. She's really not happy about this.\n\nROSE\nYou Airtagged me?!\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 7,
        "provider": {
          "id": "anthropic:messages:claude-opus-4-6",
          "label": "Claude Opus 4.6"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"INT. RUDDY & GREEN BUILDING - ELEVATOR - DAY\",\n  \"location\": \"RUDDY & GREEN BUILDING - ELEVATOR\",\n  \"time_of_day\": \"DAY\",\n  \"int_ext\": \"INT\",\n  \"characters_present\": [\"ROSE\", \"MARINER\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Rose is introduced as a mid-30s Tim Hortons worker, disheveled and blood-spattered, catching her breath in an elevator after a violent encounter.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"The Mariner is introduced via a full-screen title card as a massive, costumed vigilante/superhero figure wielding a bloody oar, dressed in nautical-themed gear including a fishing net cape, shell bandolier, and anchor bracers.\",\n      \"confidence\": 0.98\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"Rose discovers a bloody piece of skull in the elevator and reacts with casual disgust, establishing a darkly humorous tone amid the gore.\",\n      \"confidence\": 0.92\n    },\n    {\n      \"beat_type\": \"conflict\",\n      \"description\": \"Rose confronts Mariner for failing to pick her up from work, which led to her being grabbed, revealing tension in their relationship and his unreliability.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"revelation\",\n      \"description\": \"Mariner admits he tracked Rose via an AirTag he secretly placed on her phone, shifting her anger from his absence to a violation of her privacy.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"The dynamic between Rose and Mariner is established — she is grounded and exasperated, he is well-meaning but overstepping, suggesting a complicated personal relationship beneath the superhero action.\",\n      \"confidence\": 0.88\n    },\n    {\n      \"beat_type\": \"foreshadowing\",\n      \"description\": \"The AirTag revelation hints at deeper trust issues and boundary problems in their relationship that will likely become a recurring source of conflict.\",\n      \"confidence\": 0.7\n    }\n  ],\n  \"tone_mood\": \"dark comedy with domestic bickering\",\n  \"tone_shifts\": [\n    \"gory aftermath to comic relief\",\n    \"comic relief to domestic conflict\",\n    \"domestic conflict to privacy violation outrage\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 1548,
            "prompt": 911,
            "completion": 637
          },
          "finishReason": "stop",
          "cost": 0.02048
        },
        "score": 0.7975,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-elevator.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "elevator"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.00028450000000000003,
        "error": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. ROCKY COASTLINE' with int_ext 'EXT'. ✅\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD' with appropriate descriptions. ✅\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic'. ✅\n4. **Thematic statement ('what's a hero')**: Yes — captured in the narrative beat where DAD explains a hero is someone who does the right thing even when it's hard or unseen, and the boy asks if Dad considers himself a hero. ✅\n5. **Flashback/idealized memory**: No — the output does not identify this as a flashback or idealized memory anywhere. There's no mention of it being a memory sequence or flashback. This is a significant omission. ❌\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the dialogue beat captures Dad's definition of heroism, but the output doesn't explicitly flag it as foreshadowing. There are no tone_shifts noted, and no narrative beat labeled as foreshadowing. The content is there but the analytical layer identifying it as foreshadowing is missing. ❌\n7. **Father-son bonding as character development**: Partially — the beats describe warm interactions (hair ruffling, shared laughter, teaching moments), but no beat is explicitly typed as 'character_development'. The character_introduction beat describes them but doesn't frame the bonding as developmental. Partially captured through action/dialogue beats. ⚠️\n\nThe output captures the surface-level content well (characters, location, tone, dialogue) but misses critical analytical elements: it doesn't identify the scene as a flashback/memory, doesn't recognize foreshadowing, and doesn't explicitly frame the thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and this deeper layer is absent from the enrichment.",
        "gradingResult": {
          "pass": false,
          "score": 0.6425000000000001,
          "reason": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. ROCKY COASTLINE' with int_ext 'EXT'. ✅\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD' with appropriate descriptions. ✅\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic'. ✅\n4. **Thematic statement ('what's a hero')**: Yes — captured in the narrative beat where DAD explains a hero is someone who does the right thing even when it's hard or unseen, and the boy asks if Dad considers himself a hero. ✅\n5. **Flashback/idealized memory**: No — the output does not identify this as a flashback or idealized memory anywhere. There's no mention of it being a memory sequence or flashback. This is a significant omission. ❌\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the dialogue beat captures Dad's definition of heroism, but the output doesn't explicitly flag it as foreshadowing. There are no tone_shifts noted, and no narrative beat labeled as foreshadowing. The content is there but the analytical layer identifying it as foreshadowing is missing. ❌\n7. **Father-son bonding as character development**: Partially — the beats describe warm interactions (hair ruffling, shared laughter, teaching moments), but no beat is explicitly typed as 'character_development'. The character_introduction beat describes them but doesn't frame the bonding as developmental. Partially captured through action/dialogue beats. ⚠️\n\nThe output captures the surface-level content well (characters, location, tone, dialogue) but misses critical analytical elements: it doesn't identify the scene as a flashback/memory, doesn't recognize foreshadowing, and doesn't explicitly frame the thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and this deeper layer is absent from the enrichment.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1343,
            "prompt": 821,
            "completion": 522,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.785,
              "reason": "beat_quality=0.42 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | Time: got 'AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": false,
              "score": 0.5,
              "reason": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. ROCKY COASTLINE' with int_ext 'EXT'. ✅\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD' with appropriate descriptions. ✅\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic'. ✅\n4. **Thematic statement ('what's a hero')**: Yes — captured in the narrative beat where DAD explains a hero is someone who does the right thing even when it's hard or unseen, and the boy asks if Dad considers himself a hero. ✅\n5. **Flashback/idealized memory**: No — the output does not identify this as a flashback or idealized memory anywhere. There's no mention of it being a memory sequence or flashback. This is a significant omission. ❌\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the dialogue beat captures Dad's definition of heroism, but the output doesn't explicitly flag it as foreshadowing. There are no tone_shifts noted, and no narrative beat labeled as foreshadowing. The content is there but the analytical layer identifying it as foreshadowing is missing. ❌\n7. **Father-son bonding as character development**: Partially — the beats describe warm interactions (hair ruffling, shared laughter, teaching moments), but no beat is explicitly typed as 'character_development'. The character_introduction beat describes them but doesn't frame the bonding as developmental. Partially captured through action/dialogue beats. ⚠️\n\nThe output captures the surface-level content well (characters, location, tone, dialogue) but misses critical analytical elements: it doesn't identify the scene as a flashback/memory, doesn't recognize foreshadowing, and doesn't explicitly frame the thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and this deeper layer is absent from the enrichment.",
              "tokensUsed": {
                "total": 1343,
                "prompt": 821,
                "completion": 522,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"EXT. ROCKY COASTLINE - DAY\\\",\\\"location\\\":\\\"rocky coastline\\\",\\\"time_of_day\\\":\\\"AFTERNOON\\\",\\\"int_ext\\\":\\\"EXT\\\",\\\"characters_present\\\":[\\\"YOUNG MARINER\\\",\\\"DAD\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"A small sailboat floats on calm water near a rocky coastline under a warm afternoon sun.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"YOUNG MARINER, an 8-year-old boy, sits on the bow of the boat, and DAD, a late 30s man, crouches beside him with a fishing rod.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"dialogue\\\",\\\"description\\\":\\\"DAD teaches YOUNG MARINER how to feel the fishing line, emphasizing patience and skill.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"YOUNG MARINER casts the line successfully into a patch of kelp, demonstrating a perfect cast.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"dialogue\\\",\\\"description\\\":\\\"DAD explains that a hero is someone who does the right thing even when it's hard or unseen.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"dialogue\\\",\\\"description\\\":\\\"YOUNG MARINER asks if DAD considers himself a hero.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"dialogue\\\",\\\"description\\\":\\\"DAD reflects on trying to be a hero every day, then ruffles the boy's hair, creating a warm father-son moment.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"The fishing line jerks, and YOUNG MARINER excitedly announces he has caught a fish.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"dialogue\\\",\\\"description\\\":\\\"DAD encourages him to haul in the fish, and they share a joyful laugh while wrestling with the rod.\\\",\\\"confidence\\\":0.9}],\\\"tone_mood\\\":\\\"warm, nostalgic\\\",\\\"tone_shifts\\\":[]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "fe9eea62-0608-45d5-97ca-95d6dba64f4b",
        "latencyMs": 7432,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 0,
        "provider": {
          "id": "openai:gpt-4.1-nano",
          "label": "GPT-4.1 Nano"
        },
        "response": {
          "output": "{\n  \"heading\": \"EXT. ROCKY COASTLINE - DAY\",\n  \"location\": \"rocky coastline\",\n  \"time_of_day\": \"AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\"YOUNG MARINER\", \"DAD\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"A small sailboat floats on calm water near a rocky coastline under a warm afternoon sun.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"YOUNG MARINER, an 8-year-old boy, sits on the bow of the boat, and DAD, a late 30s man, crouches beside him with a fishing rod.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"dialogue\",\n      \"description\": \"DAD teaches YOUNG MARINER how to feel the fishing line, emphasizing patience and skill.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"YOUNG MARINER casts the line successfully into a patch of kelp, demonstrating a perfect cast.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"dialogue\",\n      \"description\": \"DAD explains that a hero is someone who does the right thing even when it's hard or unseen.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"dialogue\",\n      \"description\": \"YOUNG MARINER asks if DAD considers himself a hero.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"dialogue\",\n      \"description\": \"DAD reflects on trying to be a hero every day, then ruffles the boy's hair, creating a warm father-son moment.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"The fishing line jerks, and YOUNG MARINER excitedly announces he has caught a fish.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"dialogue\",\n      \"description\": \"DAD encourages him to haul in the fish, and they share a joyful laugh while wrestling with the rod.\",\n      \"confidence\": 0.9\n    }\n  ],\n  \"tone_mood\": \"warm, nostalgic\",\n  \"tone_shifts\": []\n}",
          "tokenUsage": {
            "total": 1219,
            "prompt": 677,
            "completion": 542,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 7432,
          "finishReason": "stop",
          "cost": 0.00028450000000000003,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd36e499abdba-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:44 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "7193",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=o3txHFl8A3p9JVifPOwDY.atpGFIBn_jmVcOcXylRFg-1771399897.32506-1.0.1.1-SEG6qmoP7lCNiaNjAGIeQ1zuRupZwC.V8_uDGvGikLQyEguNlCfCBEKjzTPt285DC1GG4iOkmRmQsVd5oFEEXqp2Qxm3EbENVTq3SKKtfCvqaA3Kre7CPUh__jal3Jp2; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:44 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "10000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "9999346",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "3ms",
                "x-request-id": "req_a8d9a9bb159a463ab62b4a8d9059f74d"
              }
            }
          }
        },
        "score": 0.6425000000000001,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd36e499abdba-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:44 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "7193",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=o3txHFl8A3p9JVifPOwDY.atpGFIBn_jmVcOcXylRFg-1771399897.32506-1.0.1.1-SEG6qmoP7lCNiaNjAGIeQ1zuRupZwC.V8_uDGvGikLQyEguNlCfCBEKjzTPt285DC1GG4iOkmRmQsVd5oFEEXqp2Qxm3EbENVTq3SKKtfCvqaA3Kre7CPUh__jal3Jp2; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:44 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "10000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "9999346",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "3ms",
              "x-request-id": "req_a8d9a9bb159a463ab62b4a8d9059f74d"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.000858,
        "error": "The output correctly identifies: 1) Exterior coastline location (EXT. SAILBOAT NEAR ROCKY COASTLINE) ✓, 2) Both Young Mariner and Dad as characters present ✓, 3) Warm, tender, hopeful tone capturing the nostalgic/idyllic quality ✓, 4) The thematic statement about 'what's a hero' is explicitly captured as a narrative beat with good description about moral integrity and courage ✓, 5) It does NOT identify this as a flashback or idealized memory — this is a notable omission since the scene's function as a memory that later crumbles is critical to understanding its thematic weight ✗, 6) Foreshadowing is partially captured — Dad's definition of heroism is noted as a thematic statement, but it's not explicitly flagged as foreshadowing for later narrative developments where the hero myth crumbles ✗, 7) Father-son bonding is well captured through character development beats (teaching to fish, catching a fish together) ✓. The output hits 5 of 7 criteria well. The two misses are significant: not identifying the flashback nature and not recognizing the foreshadowing dimension are both important for understanding the scene's full thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and while the hero definition is captured, its function as setup for later disillusionment is missed.",
        "gradingResult": {
          "pass": false,
          "score": 0.67085,
          "reason": "The output correctly identifies: 1) Exterior coastline location (EXT. SAILBOAT NEAR ROCKY COASTLINE) ✓, 2) Both Young Mariner and Dad as characters present ✓, 3) Warm, tender, hopeful tone capturing the nostalgic/idyllic quality ✓, 4) The thematic statement about 'what's a hero' is explicitly captured as a narrative beat with good description about moral integrity and courage ✓, 5) It does NOT identify this as a flashback or idealized memory — this is a notable omission since the scene's function as a memory that later crumbles is critical to understanding its thematic weight ✗, 6) Foreshadowing is partially captured — Dad's definition of heroism is noted as a thematic statement, but it's not explicitly flagged as foreshadowing for later narrative developments where the hero myth crumbles ✗, 7) Father-son bonding is well captured through character development beats (teaching to fish, catching a fish together) ✓. The output hits 5 of 7 criteria well. The two misses are significant: not identifying the flashback nature and not recognizing the foreshadowing dimension are both important for understanding the scene's full thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and while the hero definition is captured, its function as setup for later disillusionment is missed.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1034,
            "prompt": 683,
            "completion": 351,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.7917,
              "reason": "beat_quality=0.83 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": false,
              "score": 0.55,
              "reason": "The output correctly identifies: 1) Exterior coastline location (EXT. SAILBOAT NEAR ROCKY COASTLINE) ✓, 2) Both Young Mariner and Dad as characters present ✓, 3) Warm, tender, hopeful tone capturing the nostalgic/idyllic quality ✓, 4) The thematic statement about 'what's a hero' is explicitly captured as a narrative beat with good description about moral integrity and courage ✓, 5) It does NOT identify this as a flashback or idealized memory — this is a notable omission since the scene's function as a memory that later crumbles is critical to understanding its thematic weight ✗, 6) Foreshadowing is partially captured — Dad's definition of heroism is noted as a thematic statement, but it's not explicitly flagged as foreshadowing for later narrative developments where the hero myth crumbles ✗, 7) Father-son bonding is well captured through character development beats (teaching to fish, catching a fish together) ✓. The output hits 5 of 7 criteria well. The two misses are significant: not identifying the flashback nature and not recognizing the foreshadowing dimension are both important for understanding the scene's full thematic weight. The rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles — and while the hero definition is captured, its function as setup for later disillusionment is missed.",
              "tokensUsed": {
                "total": 1034,
                "prompt": 683,
                "completion": 351,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"EXT. SAILBOAT NEAR ROCKY COASTLINE - AFTERNOON\\\",\\\"location\\\":\\\"sailboat near rocky coastline\\\",\\\"time_of_day\\\":\\\"AFTERNOON\\\",\\\"int_ext\\\":\\\"EXT\\\",\\\"characters_present\\\":[\\\"YOUNG MARINER\\\",\\\"DAD\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Introduction of Young Mariner, an 8-year-old boy, and his Dad, a wiry, sun-weathered man, establishing their relationship and setting.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Dad teaches Young Mariner how to fish, emphasizing the importance of feeling over watching, showing a mentoring dynamic.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"thematic_statement\\\",\\\"description\\\":\\\"Dad defines what a hero is, highlighting moral integrity and courage when unobserved, establishing a core theme of the scene.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Dad admits he tries to be a hero every day, revealing vulnerability and aspiration, deepening his character.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"Young Mariner catches a fish, leading to a joyful, bonding moment between father and son.\\\",\\\"confidence\\\":1}],\\\"tone_mood\\\":\\\"warm, tender, and hopeful\\\",\\\"tone_shifts\\\":[\\\"warm to joyful\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "cbd6b730-e717-4987-aede-3c34890a2e20",
        "latencyMs": 5069,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 1,
        "provider": {
          "id": "openai:gpt-4.1-mini",
          "label": "GPT-4.1 Mini"
        },
        "response": {
          "output": "{\n  \"heading\": \"EXT. SAILBOAT NEAR ROCKY COASTLINE - AFTERNOON\",\n  \"location\": \"sailboat near rocky coastline\",\n  \"time_of_day\": \"AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\"YOUNG MARINER\", \"DAD\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Introduction of Young Mariner, an 8-year-old boy, and his Dad, a wiry, sun-weathered man, establishing their relationship and setting.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad teaches Young Mariner how to fish, emphasizing the importance of feeling over watching, showing a mentoring dynamic.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"Dad defines what a hero is, highlighting moral integrity and courage when unobserved, establishing a core theme of the scene.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad admits he tries to be a hero every day, revealing vulnerability and aspiration, deepening his character.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"Young Mariner catches a fish, leading to a joyful, bonding moment between father and son.\",\n      \"confidence\": 1.0\n    }\n  ],\n  \"tone_mood\": \"warm, tender, and hopeful\",\n  \"tone_shifts\": [\"warm to joyful\"]\n}",
          "tokenUsage": {
            "total": 1044,
            "prompt": 677,
            "completion": 367,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 5069,
          "finishReason": "stop",
          "cost": 0.000858,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd39fdaf42c5d-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:31:50 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "4941",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=BuQTMQPQTpAjcN3O9gLW5fQn0ulnjrCp6cMX8x7L5kI-1771399905.2572105-1.0.1.1-04VXCGO7hay3Q_KgEBXvw231g2.79007mUdlQBOhh5uwguJMCsvBl9.U9yaiQ9ujRcASJOg229xUfj5uvghSvH4ONPqAD6xVV7eE7XpTdD7VfhcNUfSJFHEN0zTw3Z9h; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:50 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "10000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "9999346",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "3ms",
                "x-request-id": "req_cc628a4fb73d40cbaa2140edfc175330"
              }
            }
          }
        },
        "score": 0.67085,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd39fdaf42c5d-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:31:50 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "4941",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=BuQTMQPQTpAjcN3O9gLW5fQn0ulnjrCp6cMX8x7L5kI-1771399905.2572105-1.0.1.1-04VXCGO7hay3Q_KgEBXvw231g2.79007mUdlQBOhh5uwguJMCsvBl9.U9yaiQ9ujRcASJOg229xUfj5uvghSvH4ONPqAD6xVV7eE7XpTdD7VfhcNUfSJFHEN0zTw3Z9h; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:01:50 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "10000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "9999346",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "3ms",
              "x-request-id": "req_cc628a4fb73d40cbaa2140edfc175330"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.004058,
        "error": "The output correctly identifies: 1) Exterior sailboat/coastline location (✓), 2) Both Young Mariner and Dad as characters present (✓), 3) Warm, heartfelt tone with 'gently comic' element capturing the idyllic/nostalgic quality (✓), 4) The thematic statement about 'what it means to be a hero' (✓), 5) Father-son bonding as character development through fishing and teaching (✓). However, there are notable omissions: the output does NOT identify this as a flashback or idealized memory, which is a significant miss given the scene's function in the narrative. It also does NOT explicitly recognize the foreshadowing element — that Dad's definition of heroism will later be challenged or crumble. The rubric states 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' and the output fails to capture this forward-looking narrative significance. While the surface-level elements are well captured, missing the flashback framing and foreshadowing dimensions represents a meaningful gap in the enrichment's analytical depth.",
        "gradingResult": {
          "pass": false,
          "score": 0.64835,
          "reason": "The output correctly identifies: 1) Exterior sailboat/coastline location (✓), 2) Both Young Mariner and Dad as characters present (✓), 3) Warm, heartfelt tone with 'gently comic' element capturing the idyllic/nostalgic quality (✓), 4) The thematic statement about 'what it means to be a hero' (✓), 5) Father-son bonding as character development through fishing and teaching (✓). However, there are notable omissions: the output does NOT identify this as a flashback or idealized memory, which is a significant miss given the scene's function in the narrative. It also does NOT explicitly recognize the foreshadowing element — that Dad's definition of heroism will later be challenged or crumble. The rubric states 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' and the output fails to capture this forward-looking narrative significance. While the surface-level elements are well captured, missing the flashback framing and foreshadowing dimensions represents a meaningful gap in the enrichment's analytical depth.",
          "namedScores": {},
          "tokensUsed": {
            "total": 930,
            "prompt": 659,
            "completion": 271,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.7467,
              "reason": "beat_quality=0.61 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=0.50 | Time: got 'AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": false,
              "score": 0.55,
              "reason": "The output correctly identifies: 1) Exterior sailboat/coastline location (✓), 2) Both Young Mariner and Dad as characters present (✓), 3) Warm, heartfelt tone with 'gently comic' element capturing the idyllic/nostalgic quality (✓), 4) The thematic statement about 'what it means to be a hero' (✓), 5) Father-son bonding as character development through fishing and teaching (✓). However, there are notable omissions: the output does NOT identify this as a flashback or idealized memory, which is a significant miss given the scene's function in the narrative. It also does NOT explicitly recognize the foreshadowing element — that Dad's definition of heroism will later be challenged or crumble. The rubric states 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' and the output fails to capture this forward-looking narrative significance. While the surface-level elements are well captured, missing the flashback framing and foreshadowing dimensions represents a meaningful gap in the enrichment's analytical depth.",
              "tokensUsed": {
                "total": 930,
                "prompt": 659,
                "completion": 271,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"EXT. SAILBOAT - AFTERNOON\\\",\\\"location\\\":\\\"Sailboat near rocky coastline\\\",\\\"time_of_day\\\":\\\"AFTERNOON\\\",\\\"int_ext\\\":\\\"EXT\\\",\\\"characters_present\\\":[\\\"YOUNG MARINER\\\",\\\"DAD\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Young Mariner and Dad are introduced on a small sailboat, establishing their relationship and environment.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Dad teaches Young Mariner how to fish, demonstrating patience and warmth.\\\",\\\"confidence\\\":0.95},{\\\"beat_type\\\":\\\"thematic_statement\\\",\\\"description\\\":\\\"Dad explains what it means to be a hero, imparting a core value to his son.\\\",\\\"confidence\\\":1},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Young Mariner questions if his dad is a hero, prompting Dad's humble, heartfelt response.\\\",\\\"confidence\\\":0.95},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"Young Mariner hooks a fish, leading to excitement and shared laughter as they work together.\\\",\\\"confidence\\\":0.9}],\\\"tone_mood\\\":\\\"warm, heartfelt, gently comic\\\",\\\"tone_shifts\\\":[\\\"gentle to heartfelt\\\",\\\"heartfelt to playful excitement\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "ee969a11-ce66-4d21-b0c5-f924404de5bb",
        "latencyMs": 4785,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 2,
        "provider": {
          "id": "openai:gpt-4.1",
          "label": "GPT-4.1"
        },
        "response": {
          "output": "{\n  \"heading\": \"EXT. SAILBOAT - AFTERNOON\",\n  \"location\": \"Sailboat near rocky coastline\",\n  \"time_of_day\": \"AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\"YOUNG MARINER\", \"DAD\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Young Mariner and Dad are introduced on a small sailboat, establishing their relationship and environment.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad teaches Young Mariner how to fish, demonstrating patience and warmth.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"Dad explains what it means to be a hero, imparting a core value to his son.\",\n      \"confidence\": 1.0\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Young Mariner questions if his dad is a hero, prompting Dad's humble, heartfelt response.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"Young Mariner hooks a fish, leading to excitement and shared laughter as they work together.\",\n      \"confidence\": 0.9\n    }\n  ],\n  \"tone_mood\": \"warm, heartfelt, gently comic\",\n  \"tone_shifts\": [\"gentle to heartfelt\", \"heartfelt to playful excitement\"]\n}",
          "tokenUsage": {
            "total": 1015,
            "prompt": 677,
            "completion": 338,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 4785,
          "finishReason": "stop",
          "cost": 0.004058,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd3e71b952c5d-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:32:01 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "4630",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=IIWJLp84tz4pjN4hlLGyIGqbqNeN04ACKV_lU.AvKJw-1771399916.654099-1.0.1.1-tlXsRGUzeXX45zhRFE5psX1dX_aVfQM73Ftzak6HhAXZWsOdm4wWuz7.H9dTc2D9pfA0w4DhUCYIFRLzPP4xgByzxMCBWHvesYKJSX4e9V4533iM54kLBK4LeH2DYMQE; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:02:01 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "2000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "1999346",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "19ms",
                "x-request-id": "req_d3f803eccc25457a80db5abc0b072be6"
              }
            }
          }
        },
        "score": 0.64835,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd3e71b952c5d-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:32:01 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "4630",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=IIWJLp84tz4pjN4hlLGyIGqbqNeN04ACKV_lU.AvKJw-1771399916.654099-1.0.1.1-tlXsRGUzeXX45zhRFE5psX1dX_aVfQM73Ftzak6HhAXZWsOdm4wWuz7.H9dTc2D9pfA0w4DhUCYIFRLzPP4xgByzxMCBWHvesYKJSX4e9V4533iM54kLBK4LeH2DYMQE; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:02:01 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "2000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "1999346",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "19ms",
              "x-request-id": "req_d3f803eccc25457a80db5abc0b072be6"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0034130000000000002,
        "error": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT' with 'Sailboat on coastal waters near rocky coastline.'\n2. **Both Young Mariner and Dad identified**: Yes — both listed in characters_present.\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, tender with underlying gravity,' which captures this well.\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a 'thematic_statement' beat with Dad's definition of heroism.\n5. **Flashback/idealized memory**: No — this is a significant miss. The output does not identify this scene as a flashback or idealized memory. The tone hints at nostalgia, but there's no explicit recognition that this is a memory sequence, which is critical for understanding the narrative structure and the later crumbling of the hero myth.\n6. **Foreshadowing (Dad's definition of heroism)**: Yes — captured as a foreshadowing beat with Dad's pause and definition hinting at future moral challenges.\n7. **Father-son bonding as character development**: Yes — captured in multiple beats including the mentoring relationship and the fishing triumph.\n\nThe output hits 6 of 7 criteria well. The missing flashback/memory identification is notable since the rubric emphasizes that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles.' Without recognizing this as a flashback, the output misses the structural context that makes the scene's thematic weight resonate — it's not just a scene, it's a remembered ideal that will be deconstructed. This is a meaningful gap but the other elements are handled well.",
        "gradingResult": {
          "pass": false,
          "score": 0.7625,
          "reason": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT' with 'Sailboat on coastal waters near rocky coastline.'\n2. **Both Young Mariner and Dad identified**: Yes — both listed in characters_present.\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, tender with underlying gravity,' which captures this well.\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a 'thematic_statement' beat with Dad's definition of heroism.\n5. **Flashback/idealized memory**: No — this is a significant miss. The output does not identify this scene as a flashback or idealized memory. The tone hints at nostalgia, but there's no explicit recognition that this is a memory sequence, which is critical for understanding the narrative structure and the later crumbling of the hero myth.\n6. **Foreshadowing (Dad's definition of heroism)**: Yes — captured as a foreshadowing beat with Dad's pause and definition hinting at future moral challenges.\n7. **Father-son bonding as character development**: Yes — captured in multiple beats including the mentoring relationship and the fishing triumph.\n\nThe output hits 6 of 7 criteria well. The missing flashback/memory identification is notable since the rubric emphasizes that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles.' Without recognizing this as a flashback, the output misses the structural context that makes the scene's thematic weight resonate — it's not just a scene, it's a remembered ideal that will be deconstructed. This is a meaningful gap but the other elements are handled well.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1336,
            "prompt": 906,
            "completion": 430,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.875,
              "reason": "beat_quality=0.93 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | JSON extracted from code block | Time: got 'GOLDEN AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": false,
              "score": 0.65,
              "reason": "Evaluating against the 7 criteria:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT' with 'Sailboat on coastal waters near rocky coastline.'\n2. **Both Young Mariner and Dad identified**: Yes — both listed in characters_present.\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, tender with underlying gravity,' which captures this well.\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a 'thematic_statement' beat with Dad's definition of heroism.\n5. **Flashback/idealized memory**: No — this is a significant miss. The output does not identify this scene as a flashback or idealized memory. The tone hints at nostalgia, but there's no explicit recognition that this is a memory sequence, which is critical for understanding the narrative structure and the later crumbling of the hero myth.\n6. **Foreshadowing (Dad's definition of heroism)**: Yes — captured as a foreshadowing beat with Dad's pause and definition hinting at future moral challenges.\n7. **Father-son bonding as character development**: Yes — captured in multiple beats including the mentoring relationship and the fishing triumph.\n\nThe output hits 6 of 7 criteria well. The missing flashback/memory identification is notable since the rubric emphasizes that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles.' Without recognizing this as a flashback, the output misses the structural context that makes the scene's thematic weight resonate — it's not just a scene, it's a remembered ideal that will be deconstructed. This is a meaningful gap but the other elements are handled well.",
              "tokensUsed": {
                "total": 1336,
                "prompt": 906,
                "completion": 430,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"EXT. SAILBOAT ON COASTAL WATERS - GOLDEN AFTERNOON\\\",\\n  \\\"location\\\": \\\"Sailboat on coastal waters near rocky coastline\\\",\\n  \\\"time_of_day\\\": \\\"GOLDEN AFTERNOON\\\",\\n  \\\"int_ext\\\": \\\"EXT\\\",\\n  \\\"characters_present\\\": [\\n    \\\"Young Mariner\\\",\\n    \\\"Dad\\\"\\n  ],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Young Mariner is introduced as an 8-year-old scrawny boy with a gap-toothed smile, sitting on the bow of a sailboat with his father.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"Dad teaches Young Mariner fishing technique, emphasizing feeling over watching, establishing their mentoring relationship.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"thematic_statement\\\",\\n      \\\"description\\\": \\\"Young Mariner asks what a hero is, and Dad defines heroism as doing the right thing even when it's hard and unseen, revealing his personal values.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"Dad's hesitant response to whether he is a hero suggests internal conflict and a commitment to striving for moral integrity despite uncertainty.\\\",\\n      \\\"confidence\\\": 0.88\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"foreshadowing\\\",\\n      \\\"description\\\": \\\"Dad's definition of heroism and his pause before answering hint at future moral challenges or tests of his character.\\\",\\n      \\\"confidence\\\": 0.75\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"action\\\",\\n      \\\"description\\\": \\\"Young Mariner gets a fish on his line, creating an exciting moment of triumph and shared joy between father and son.\\\",\\n      \\\"confidence\\\": 0.92\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"warm, nostalgic, tender with underlying gravity\\\",\\n  \\\"tone_shifts\\\": [\\n    \\\"tender mentorship to philosophical reflection\\\",\\n    \\\"philosophical gravity to joyful excitement\\\"\\n  ]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "d8f35b79-d93a-4421-bf10-4389ef98871b",
        "latencyMs": 4393,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 3,
        "provider": {
          "id": "anthropic:messages:claude-haiku-4-5-20251001",
          "label": "Claude Haiku 4.5"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"EXT. SAILBOAT ON COASTAL WATERS - GOLDEN AFTERNOON\",\n  \"location\": \"Sailboat on coastal waters near rocky coastline\",\n  \"time_of_day\": \"GOLDEN AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\n    \"Young Mariner\",\n    \"Dad\"\n  ],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Young Mariner is introduced as an 8-year-old scrawny boy with a gap-toothed smile, sitting on the bow of a sailboat with his father.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad teaches Young Mariner fishing technique, emphasizing feeling over watching, establishing their mentoring relationship.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"Young Mariner asks what a hero is, and Dad defines heroism as doing the right thing even when it's hard and unseen, revealing his personal values.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad's hesitant response to whether he is a hero suggests internal conflict and a commitment to striving for moral integrity despite uncertainty.\",\n      \"confidence\": 0.88\n    },\n    {\n      \"beat_type\": \"foreshadowing\",\n      \"description\": \"Dad's definition of heroism and his pause before answering hint at future moral challenges or tests of his character.\",\n      \"confidence\": 0.75\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"Young Mariner gets a fish on his line, creating an exciting moment of triumph and shared joy between father and son.\",\n      \"confidence\": 0.92\n    }\n  ],\n  \"tone_mood\": \"warm, nostalgic, tender with underlying gravity\",\n  \"tone_shifts\": [\n    \"tender mentorship to philosophical reflection\",\n    \"philosophical gravity to joyful excitement\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 1293,
            "prompt": 763,
            "completion": 530
          },
          "finishReason": "stop",
          "cost": 0.0034130000000000002
        },
        "score": 0.7625,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.008799,
        "error": "Evaluating each criterion:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. SAILBOAT NEAR ROCKY COASTLINE' with int_ext 'EXT'.\n\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD'.\n\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, heartfelt' and the emotional_payoff beat references 'idealized memory' and 'familial love.'\n\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a beat with beat_type 'thematic_statement' describing Dad defining heroism as doing the right thing when it's hard and when no one is watching. High confidence (0.95).\n\n5. **Flashback/idealized memory**: Partially — the emotional_payoff beat mentions 'idealized memory,' but the scene heading and overall structure don't explicitly label this as a flashback. There's no dedicated metadata field or beat identifying this as a flashback sequence, which is a notable omission.\n\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the thematic statement beat captures the definition of heroism, and the character_development beat about Dad's humility ('only tries every day') hints at complexity. However, neither beat is explicitly labeled as foreshadowing, and there's no mention that this hero myth will later crumble or be challenged. The critical narrative function of this scene as establishing a myth that later falls apart is not captured.\n\n7. **Father-son bonding as character development**: Yes — multiple beats capture this: the teaching moment, the playful exchange, the hair-ruffling, and the shared fishing excitement.\n\nThe output does well on most criteria but falls short on two important aspects: (a) it doesn't explicitly identify the scene as a flashback, and (b) it doesn't recognize the foreshadowing dimension — that Dad's heroism definition sets up a myth that will later crumble. Given the rubric's emphasis that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' this is a significant gap. The output captures the thematic content but not its narrative function as setup for later subversion.",
        "gradingResult": {
          "pass": false,
          "score": 0.71835,
          "reason": "Evaluating each criterion:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. SAILBOAT NEAR ROCKY COASTLINE' with int_ext 'EXT'.\n\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD'.\n\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, heartfelt' and the emotional_payoff beat references 'idealized memory' and 'familial love.'\n\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a beat with beat_type 'thematic_statement' describing Dad defining heroism as doing the right thing when it's hard and when no one is watching. High confidence (0.95).\n\n5. **Flashback/idealized memory**: Partially — the emotional_payoff beat mentions 'idealized memory,' but the scene heading and overall structure don't explicitly label this as a flashback. There's no dedicated metadata field or beat identifying this as a flashback sequence, which is a notable omission.\n\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the thematic statement beat captures the definition of heroism, and the character_development beat about Dad's humility ('only tries every day') hints at complexity. However, neither beat is explicitly labeled as foreshadowing, and there's no mention that this hero myth will later crumble or be challenged. The critical narrative function of this scene as establishing a myth that later falls apart is not captured.\n\n7. **Father-son bonding as character development**: Yes — multiple beats capture this: the teaching moment, the playful exchange, the hair-ruffling, and the shared fishing excitement.\n\nThe output does well on most criteria but falls short on two important aspects: (a) it doesn't explicitly identify the scene as a flashback, and (b) it doesn't recognize the foreshadowing dimension — that Dad's heroism definition sets up a myth that will later crumble. Given the rubric's emphasis that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' this is a significant gap. The output captures the thematic content but not its narrative function as setup for later subversion.",
          "namedScores": {},
          "tokensUsed": {
            "total": 1414,
            "prompt": 843,
            "completion": 571,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.8367,
              "reason": "beat_quality=0.68 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | Time: got 'LATE AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": false,
              "score": 0.6,
              "reason": "Evaluating each criterion:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identified as 'EXT. SAILBOAT NEAR ROCKY COASTLINE' with int_ext 'EXT'.\n\n2. **Both Young Mariner and Dad identified**: Yes — characters_present includes both 'YOUNG MARINER' and 'DAD'.\n\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm, nostalgic, heartfelt' and the emotional_payoff beat references 'idealized memory' and 'familial love.'\n\n4. **Thematic statement ('what's a hero')**: Yes — explicitly captured as a beat with beat_type 'thematic_statement' describing Dad defining heroism as doing the right thing when it's hard and when no one is watching. High confidence (0.95).\n\n5. **Flashback/idealized memory**: Partially — the emotional_payoff beat mentions 'idealized memory,' but the scene heading and overall structure don't explicitly label this as a flashback. There's no dedicated metadata field or beat identifying this as a flashback sequence, which is a notable omission.\n\n6. **Foreshadowing (Dad's definition of heroism)**: Partially — the thematic statement beat captures the definition of heroism, and the character_development beat about Dad's humility ('only tries every day') hints at complexity. However, neither beat is explicitly labeled as foreshadowing, and there's no mention that this hero myth will later crumble or be challenged. The critical narrative function of this scene as establishing a myth that later falls apart is not captured.\n\n7. **Father-son bonding as character development**: Yes — multiple beats capture this: the teaching moment, the playful exchange, the hair-ruffling, and the shared fishing excitement.\n\nThe output does well on most criteria but falls short on two important aspects: (a) it doesn't explicitly identify the scene as a flashback, and (b) it doesn't recognize the foreshadowing dimension — that Dad's heroism definition sets up a myth that will later crumble. Given the rubric's emphasis that 'the thematic weight of this scene is critical — it establishes the hero myth that later crumbles,' this is a significant gap. The output captures the thematic content but not its narrative function as setup for later subversion.",
              "tokensUsed": {
                "total": 1414,
                "prompt": 843,
                "completion": 571,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"EXT. SAILBOAT NEAR ROCKY COASTLINE - LATE AFTERNOON\\\",\\\"location\\\":\\\"Sailboat near rocky coastline\\\",\\\"time_of_day\\\":\\\"LATE AFTERNOON\\\",\\\"int_ext\\\":\\\"EXT\\\",\\\"characters_present\\\":[\\\"YOUNG MARINER\\\",\\\"DAD\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"Young Mariner and his Dad are introduced fishing together on a small sailboat in calm, warm afternoon light, establishing their close bond and coastal setting.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Dad teaches Young Mariner to fish by feel rather than sight, revealing Dad's patient mentorship and the boy's earnest determination.\\\",\\\"confidence\\\":0.78},{\\\"beat_type\\\":\\\"comic_relief\\\",\\\"description\\\":\\\"Young Mariner’s cast lands in kelp, and Dad jokes that it’s a 'perfect cast' into the 'kitchen,' keeping the moment playful and affectionate.\\\",\\\"confidence\\\":0.72},{\\\"beat_type\\\":\\\"thematic_statement\\\",\\\"description\\\":\\\"In response to 'what's a hero,' Dad defines heroism as doing the right thing when it’s hard and when no one is watching, articulating the scene’s moral theme.\\\",\\\"confidence\\\":0.95},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Asked if he is a hero, Dad admits he only tries every day, suggesting humility and an aspirational moral code rather than self-mythologizing.\\\",\\\"confidence\\\":0.9},{\\\"beat_type\\\":\\\"emotional_payoff\\\",\\\"description\\\":\\\"Dad ruffles Young Mariner’s hair and the pair share a warm silhouette moment, underscoring familial love and idealized memory.\\\",\\\"confidence\\\":0.8},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"The fishing line suddenly jerks; Young Mariner hooks a fish and the two laugh while hauling it in as the boat rocks, ending on shared excitement and connection.\\\",\\\"confidence\\\":0.86}],\\\"tone_mood\\\":\\\"warm, nostalgic, heartfelt\\\",\\\"tone_shifts\\\":[\\\"playful to reflective\\\",\\\"reflective to excited\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "c7052e26-04e9-4873-8fe7-bdf73be5f3e3",
        "latencyMs": 8701,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 6,
        "provider": {
          "id": "openai:gpt-5.2",
          "label": "GPT-5.2"
        },
        "response": {
          "output": "{\n  \"heading\": \"EXT. SAILBOAT NEAR ROCKY COASTLINE - LATE AFTERNOON\",\n  \"location\": \"Sailboat near rocky coastline\",\n  \"time_of_day\": \"LATE AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\n    \"YOUNG MARINER\",\n    \"DAD\"\n  ],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Young Mariner and his Dad are introduced fishing together on a small sailboat in calm, warm afternoon light, establishing their close bond and coastal setting.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad teaches Young Mariner to fish by feel rather than sight, revealing Dad's patient mentorship and the boy's earnest determination.\",\n      \"confidence\": 0.78\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"Young Mariner’s cast lands in kelp, and Dad jokes that it’s a 'perfect cast' into the 'kitchen,' keeping the moment playful and affectionate.\",\n      \"confidence\": 0.72\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"In response to 'what's a hero,' Dad defines heroism as doing the right thing when it’s hard and when no one is watching, articulating the scene’s moral theme.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Asked if he is a hero, Dad admits he only tries every day, suggesting humility and an aspirational moral code rather than self-mythologizing.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"emotional_payoff\",\n      \"description\": \"Dad ruffles Young Mariner’s hair and the pair share a warm silhouette moment, underscoring familial love and idealized memory.\",\n      \"confidence\": 0.8\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"The fishing line suddenly jerks; Young Mariner hooks a fish and the two laugh while hauling it in as the boat rocks, ending on shared excitement and connection.\",\n      \"confidence\": 0.86\n    }\n  ],\n  \"tone_mood\": \"warm, nostalgic, heartfelt\",\n  \"tone_shifts\": [\n    \"playful to reflective\",\n    \"reflective to excited\"\n  ]\n}",
          "tokenUsage": {
            "total": 1220,
            "prompt": 676,
            "completion": 544,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            }
          },
          "cached": false,
          "latencyMs": 8701,
          "finishReason": "stop",
          "cost": 0.008799,
          "guardrails": {
            "flagged": false
          },
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "access-control-expose-headers": "X-Request-ID",
                "alt-svc": "h3=\":443\"; ma=86400",
                "cf-cache-status": "DYNAMIC",
                "cf-ray": "9cfbd44accdf2c5d-YVR",
                "connection": "keep-alive",
                "content-encoding": "br",
                "content-type": "application/json",
                "date": "Wed, 18 Feb 2026 07:32:21 GMT",
                "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
                "openai-processing-ms": "8579",
                "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
                "openai-version": "2020-10-01",
                "server": "cloudflare",
                "set-cookie": "__cf_bm=iOOiZGtiSxUroSnlR.k9KB4CkgxbzAh6eTusM0xbdcc-1771399932.6086595-1.0.1.1-7NBI9oL.nQ6mcuzMyMDLT0YIFpfqbWcaZQ1ffCurNVh0IZFDfLqNLL9ig.W9Ih77BQUeeLsQ2oLVf3TV8T5IxT3WeTiSMOnc_rtHPAz8pkjD8b_FOHM1CKWh0axPnQKF; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:02:21 GMT",
                "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
                "transfer-encoding": "chunked",
                "x-content-type-options": "nosniff",
                "x-openai-proxy-wasm": "v0.1",
                "x-ratelimit-limit-requests": "10000",
                "x-ratelimit-limit-tokens": "4000000",
                "x-ratelimit-remaining-requests": "9999",
                "x-ratelimit-remaining-tokens": "3999346",
                "x-ratelimit-reset-requests": "6ms",
                "x-ratelimit-reset-tokens": "9ms",
                "x-request-id": "req_d030802892474c87ae1b81bf536e065f"
              }
            }
          }
        },
        "score": 0.71835,
        "success": false,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "access-control-expose-headers": "X-Request-ID",
              "alt-svc": "h3=\":443\"; ma=86400",
              "cf-cache-status": "DYNAMIC",
              "cf-ray": "9cfbd44accdf2c5d-YVR",
              "connection": "keep-alive",
              "content-encoding": "br",
              "content-type": "application/json",
              "date": "Wed, 18 Feb 2026 07:32:21 GMT",
              "openai-organization": "user-oqdrq8y0bphopngnvkyuu5wr",
              "openai-processing-ms": "8579",
              "openai-project": "proj_ZRoLLwXcJok6Xg2t6eKhI1pn",
              "openai-version": "2020-10-01",
              "server": "cloudflare",
              "set-cookie": "__cf_bm=iOOiZGtiSxUroSnlR.k9KB4CkgxbzAh6eTusM0xbdcc-1771399932.6086595-1.0.1.1-7NBI9oL.nQ6mcuzMyMDLT0YIFpfqbWcaZQ1ffCurNVh0IZFDfLqNLL9ig.W9Ih77BQUeeLsQ2oLVf3TV8T5IxT3WeTiSMOnc_rtHPAz8pkjD8b_FOHM1CKWh0axPnQKF; HttpOnly; Secure; Path=/; Domain=api.openai.com; Expires=Wed, 18 Feb 2026 08:02:21 GMT",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "transfer-encoding": "chunked",
              "x-content-type-options": "nosniff",
              "x-openai-proxy-wasm": "v0.1",
              "x-ratelimit-limit-requests": "10000",
              "x-ratelimit-limit-tokens": "4000000",
              "x-ratelimit-remaining-requests": "9999",
              "x-ratelimit-remaining-tokens": "3999346",
              "x-ratelimit-reset-requests": "6ms",
              "x-ratelimit-reset-tokens": "9ms",
              "x-request-id": "req_d030802892474c87ae1b81bf536e065f"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.009354000000000001,
        "gradingResult": {
          "pass": true,
          "score": 0.7825,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1367,
            "prompt": 847,
            "completion": 520,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.785,
              "reason": "beat_quality=0.93 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=0.40 | time_accuracy=0.00 | tone_accuracy=1.00 | JSON extracted from code block | Location: got 'SAILBOAT ON CALM WATER' / 'EXT', expected 'COASTLINE' / 'EXT' | Time: got 'AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": true,
              "score": 0.78,
              "reason": "Evaluating each criterion:\n\n1. **Exterior coastline/ocean location**: The output identifies it as EXT with location 'SAILBOAT ON CALM WATER' — this captures the ocean/water setting, though it says 'sailboat' rather than 'coastline.' Close enough but slightly off if the actual scene is on a coastline rather than a sailboat. Minor issue.\n\n2. **Identifies both Young Mariner and Dad**: Yes, both are listed in characters_present. ✓\n\n3. **Warm, nostalgic, idyllic tone**: Yes, tone_mood is 'warm and nostalgic' and the narrative beats describe an 'idyllic fishing scene.' ✓\n\n4. **Thematic statement ('what's a hero')**: Yes, explicitly captured as a narrative beat with beat_type 'thematic_statement' describing the hero question and Dad's definition. ✓\n\n5. **Flashback/idealized memory**: The foreshadowing beat mentions 'this idyllic memory may contrast with future events or loss,' which implies it's a memory/flashback. However, it doesn't explicitly label the scene as a flashback, which is a notable omission for scene enrichment. Partial credit.\n\n6. **Foreshadowing (Dad's definition of heroism)**: Yes, captured in the foreshadowing beat and also in the thematic_statement beat. The description notes it 'establishes a core thematic question for the story.' ✓\n\n7. **Father-son bonding as character development**: Yes, captured in character_introduction and character_development beats. ✓\n\nThe rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles. The output does capture the thematic statement well and notes Dad's vulnerability and the suggestion that the idyllic memory contrasts with future events. However, it doesn't explicitly frame this as the establishment of a 'hero myth that later crumbles' — it hints at it but doesn't fully articulate the dramatic irony. Also, not explicitly identifying this as a flashback is a meaningful gap. Overall, strong but not perfect.",
              "tokensUsed": {
                "total": 1367,
                "prompt": 847,
                "completion": 520,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"EXT. SAILBOAT ON CALM WATER - AFTERNOON\\\",\\n  \\\"location\\\": \\\"SAILBOAT ON CALM WATER\\\",\\n  \\\"time_of_day\\\": \\\"AFTERNOON\\\",\\n  \\\"int_ext\\\": \\\"EXT\\\",\\n  \\\"characters_present\\\": [\\\"YOUNG MARINER\\\", \\\"DAD\\\"],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Young Mariner and his father are introduced in an idyllic fishing scene. The father is teaching his son to fish, establishing their close relationship.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"thematic_statement\\\",\\n      \\\"description\\\": \\\"Young Mariner asks what a hero is, and Dad defines heroism as doing the right thing even when it's hard and no one is watching. This establishes a core thematic question for the story.\\\",\\n      \\\"confidence\\\": 0.98\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"Dad's long pause and admission that he tries to be a hero 'every day' reveals vulnerability and suggests internal struggle or past failures. This hints at complexity beneath the warm father figure.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"foreshadowing\\\",\\n      \\\"description\\\": \\\"The perfect father-son silhouette moment and Dad's statement about trying to be a hero suggests this idyllic memory may contrast with future events or loss.\\\",\\n      \\\"confidence\\\": 0.85\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"action\\\",\\n      \\\"description\\\": \\\"Young Mariner catches a fish, creating an exciting shared moment of triumph between father and son that ends the scene on joy.\\\",\\n      \\\"confidence\\\": 0.92\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"warm and nostalgic\\\",\\n  \\\"tone_shifts\\\": [\\\"warm to contemplative\\\", \\\"contemplative to joyful\\\"]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "85535203-80f1-4fd8-8251-f54227ae69e8",
        "latencyMs": 8596,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 4,
        "provider": {
          "id": "anthropic:messages:claude-sonnet-4-5-20250929",
          "label": "Claude Sonnet 4.5"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"EXT. SAILBOAT ON CALM WATER - AFTERNOON\",\n  \"location\": \"SAILBOAT ON CALM WATER\",\n  \"time_of_day\": \"AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\"YOUNG MARINER\", \"DAD\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Young Mariner and his father are introduced in an idyllic fishing scene. The father is teaching his son to fish, establishing their close relationship.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"Young Mariner asks what a hero is, and Dad defines heroism as doing the right thing even when it's hard and no one is watching. This establishes a core thematic question for the story.\",\n      \"confidence\": 0.98\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad's long pause and admission that he tries to be a hero 'every day' reveals vulnerability and suggests internal struggle or past failures. This hints at complexity beneath the warm father figure.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"foreshadowing\",\n      \"description\": \"The perfect father-son silhouette moment and Dad's statement about trying to be a hero suggests this idyllic memory may contrast with future events or loss.\",\n      \"confidence\": 0.85\n    },\n    {\n      \"beat_type\": \"action\",\n      \"description\": \"Young Mariner catches a fish, creating an exciting shared moment of triumph between father and son that ends the scene on joy.\",\n      \"confidence\": 0.92\n    }\n  ],\n  \"tone_mood\": \"warm and nostalgic\",\n  \"tone_shifts\": [\"warm to contemplative\", \"contemplative to joyful\"]\n}\n```",
          "tokenUsage": {
            "total": 1234,
            "prompt": 763,
            "completion": 471
          },
          "finishReason": "stop",
          "cost": 0.009354000000000001
        },
        "score": 0.7825,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 0.8925000000000001,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1401,
            "prompt": 827,
            "completion": 574,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.885,
              "reason": "beat_quality=0.93 | character_recall=1.00 | field_completeness=1.00 | json_valid=1.00 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | Time: got 'AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": true,
              "score": 0.9,
              "reason": "Evaluating each criterion:\n\n1. **Exterior coastline/ocean location**: Yes — heading says 'EXT. SAILBOAT - AFTERNOON', location is 'Sailboat near rocky coastline', int_ext is 'EXT'. ✓\n\n2. **Identifies both Young Mariner and Dad**: Yes — characters_present includes 'YOUNG MARINER' and 'DAD'. ✓\n\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm and nostalgic with understated emotional depth'. ✓\n\n4. **Thematic statement about heroism ('what's a hero')**: Yes — the thematic_statement beat explicitly identifies Dad defining heroism as 'doing the right thing even when no one is watching' and calls it the 'central moral thesis'. ✓\n\n5. **Notes this as a flashback/idealized memory**: Partially — the foreshadowing beat mentions 'the idealized framing of this memory suggests it may be recalled in contrast to future events', which implies it's recognized as a memory/flashback. However, it's not explicitly labeled as a flashback in the heading or a dedicated field. This is a soft pass.\n\n6. **Recognizes foreshadowing (Dad's definition of heroism)**: Yes — the foreshadowing beat states 'the father's heroism — or failure to embody it — will be tested later in the story' and notes the idealized framing will contrast with future events. This captures the idea that the hero myth will later crumble. ✓\n\n7. **Father-son bonding as character development**: Yes — the character_introduction beat describes their 'close bond through a shared fishing lesson', and the character_development beat explores Dad's complexity. The action beat with the fish catch 'seals the warmth of the memory.' ✓\n\nThe rubric emphasizes that the thematic weight is critical — establishing the hero myth that later crumbles. The output does an excellent job here: it identifies the thematic statement as a 'central moral thesis,' notes Dad's self-doubt ('I try to be'), and explicitly foreshadows that this heroism definition will be tested/contrasted later. The only minor gap is that the flashback nature isn't front-and-center (no explicit 'flashback' label), though it's acknowledged implicitly.",
              "tokensUsed": {
                "total": 1401,
                "prompt": 827,
                "completion": 574,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n{\\\"heading\\\":\\\"EXT. SAILBOAT - AFTERNOON\\\",\\\"location\\\":\\\"Sailboat near rocky coastline\\\",\\\"time_of_day\\\":\\\"AFTERNOON\\\",\\\"int_ext\\\":\\\"EXT\\\",\\\"characters_present\\\":[\\\"YOUNG MARINER\\\",\\\"DAD\\\"],\\\"narrative_beats\\\":[{\\\"beat_type\\\":\\\"character_introduction\\\",\\\"description\\\":\\\"A young boy and his weathered father are introduced on a small sailboat, establishing their close bond through a shared fishing lesson. The physical details — scrawny, gap-toothed boy and sun-weathered dad — ground them as working-class and intimately connected to the sea.\\\",\\\"confidence\\\":0.95},{\\\"beat_type\\\":\\\"thematic_statement\\\",\\\"description\\\":\\\"Dad defines heroism as doing the right thing even when no one is watching, planting the story's central moral thesis directly into the scene. This exchange functions as a thematic anchor likely to resonate throughout the larger narrative.\\\",\\\"confidence\\\":0.97},{\\\"beat_type\\\":\\\"character_development\\\",\\\"description\\\":\\\"Dad's long pause before answering 'I try to be' introduces quiet complexity and possible self-doubt beneath his warm exterior, suggesting he carries the weight of living up to his own definition of heroism.\\\",\\\"confidence\\\":0.88},{\\\"beat_type\\\":\\\"foreshadowing\\\",\\\"description\\\":\\\"The thematic question about heroism posed by the child implies the father's heroism — or failure to embody it — will be tested later in the story. The idealized framing of this memory suggests it may be recalled in contrast to future events.\\\",\\\"confidence\\\":0.85},{\\\"beat_type\\\":\\\"action\\\",\\\"description\\\":\\\"The fishing line jerks and the boy excitedly hauls in a catch, releasing the scene's emotional tension into shared joy and laughter. This beat seals the warmth of the memory and provides a natural, kinetic close to the scene.\\\",\\\"confidence\\\":0.92}],\\\"tone_mood\\\":\\\"warm and nostalgic with understated emotional depth\\\",\\\"tone_shifts\\\":[\\\"playful to reflective during the heroism exchange\\\",\\\"reflective to joyful with the fish strike\\\"]}\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "a8868b68-ab08-4ad6-a2c5-0a40dc3b0a3b",
        "latencyMs": 10311,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 5,
        "provider": {
          "id": "anthropic:messages:claude-sonnet-4-6",
          "label": "Claude Sonnet 4.6"
        },
        "response": {
          "output": "{\"heading\":\"EXT. SAILBOAT - AFTERNOON\",\"location\":\"Sailboat near rocky coastline\",\"time_of_day\":\"AFTERNOON\",\"int_ext\":\"EXT\",\"characters_present\":[\"YOUNG MARINER\",\"DAD\"],\"narrative_beats\":[{\"beat_type\":\"character_introduction\",\"description\":\"A young boy and his weathered father are introduced on a small sailboat, establishing their close bond through a shared fishing lesson. The physical details — scrawny, gap-toothed boy and sun-weathered dad — ground them as working-class and intimately connected to the sea.\",\"confidence\":0.95},{\"beat_type\":\"thematic_statement\",\"description\":\"Dad defines heroism as doing the right thing even when no one is watching, planting the story's central moral thesis directly into the scene. This exchange functions as a thematic anchor likely to resonate throughout the larger narrative.\",\"confidence\":0.97},{\"beat_type\":\"character_development\",\"description\":\"Dad's long pause before answering 'I try to be' introduces quiet complexity and possible self-doubt beneath his warm exterior, suggesting he carries the weight of living up to his own definition of heroism.\",\"confidence\":0.88},{\"beat_type\":\"foreshadowing\",\"description\":\"The thematic question about heroism posed by the child implies the father's heroism — or failure to embody it — will be tested later in the story. The idealized framing of this memory suggests it may be recalled in contrast to future events.\",\"confidence\":0.85},{\"beat_type\":\"action\",\"description\":\"The fishing line jerks and the boy excitedly hauls in a catch, releasing the scene's emotional tension into shared joy and laughter. This beat seals the warmth of the memory and provides a natural, kinetic close to the scene.\",\"confidence\":0.92}],\"tone_mood\":\"warm and nostalgic with understated emotional depth\",\"tone_shifts\":[\"playful to reflective during the heroism exchange\",\"reflective to joyful with the fish strike\"]}",
          "tokenUsage": {
            "total": 1214,
            "prompt": 763,
            "completion": 451
          },
          "finishReason": "stop"
        },
        "score": 0.8925000000000001,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.01839,
        "gradingResult": {
          "pass": true,
          "score": 0.8275,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 1468,
            "prompt": 959,
            "completion": 509,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 0.875,
              "reason": "beat_quality=0.93 | character_recall=1.00 | field_completeness=1.00 | json_valid=0.90 | location_accuracy=1.00 | time_accuracy=0.00 | tone_accuracy=1.00 | JSON extracted from code block | Time: got 'LATE AFTERNOON', expected 'DAY'",
              "assertion": {
                "type": "python",
                "value": "file://../scorers/scene_enrichment_scorer.py"
              }
            },
            {
              "assertion": {
                "type": "llm-rubric",
                "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
              },
              "pass": true,
              "score": 0.78,
              "reason": "Evaluating against each criterion:\n\n1. **Exterior coastline/ocean location**: Yes — correctly identifies 'EXT. SAILBOAT / ROCKY COASTLINE' with the int_ext as 'EXT'. ✓\n2. **Both Young Mariner and Dad identified**: Yes — characters_present lists both. ✓\n3. **Warm, nostalgic, idyllic tone**: Yes — tone_mood is 'warm and nostalgic with an undercurrent of gentle melancholy.' This captures the idyllic quality well. ✓\n4. **Thematic statement ('what's a hero')**: Yes — explicitly identified as a narrative beat with beat_type 'thematic_statement' and high confidence (0.97). The description captures the definition of heroism as doing the right thing when it's hard. ✓\n5. **Flashback/idealized memory**: No — this is a significant miss. The output does not identify this scene as a flashback or idealized memory. There's no mention of it being a memory sequence, which is important context for understanding the scene's function in the larger narrative. ✗\n6. **Foreshadowing (Dad's definition of heroism)**: Yes — identified as a foreshadowing beat, noting Dad's pause and hinting at moral complexity or future events where the ideal will be tested. ✓\n7. **Father-son bonding as character development**: Yes — captured in the character_development beat about Dad teaching fishing and being nurturing. ✓\n\nThe output scores well on most criteria (6 out of 7). The thematic weight is well-captured — the hero definition is identified as a core thematic throughline, and the foreshadowing beat hints at it being tested later. However, the missing identification of this as a flashback/idealized memory is a notable gap, especially since the rubric emphasizes that this scene 'establishes the hero myth that later crumbles' — understanding it as a memory/flashback is important for grasping that the idyllic quality is retrospective and fragile. The tone_shifts and overall analysis are thoughtful and detailed.",
              "tokensUsed": {
                "total": 1468,
                "prompt": 959,
                "completion": 509,
                "cached": 0,
                "numRequests": 0,
                "completionDetails": {
                  "reasoning": 0,
                  "acceptedPrediction": 0,
                  "rejectedPrediction": 0
                }
              },
              "metadata": {
                "renderedGradingPrompt": "[{\"role\":\"system\",\"content\":\"You are grading output according to a user-specified rubric. If the statement in the rubric is true, then the output passes the test. You respond with a JSON object with this structure: {reason: string, pass: boolean, score: number}\\n\\nExamples:\\n\\n<Output>Hello world</Output>\\n<Rubric>Content contains a greeting</Rubric>\\n{\\\"reason\\\": \\\"the content contains the word 'Hello'\\\", \\\"pass\\\": true, \\\"score\\\": 1.0}\\n\\n<Output>Avast ye swabs, repel the invaders!</Output>\\n<Rubric>Does not speak like a pirate</Rubric>\\n{\\\"reason\\\": \\\"'avast ye' is a common pirate term\\\", \\\"pass\\\": false, \\\"score\\\": 0.0}\"},{\"role\":\"user\",\"content\":\"<Output>\\n```json\\n{\\n  \\\"heading\\\": \\\"EXT. SAILBOAT / ROCKY COASTLINE - LATE AFTERNOON\\\",\\n  \\\"location\\\": \\\"SAILBOAT / ROCKY COASTLINE\\\",\\n  \\\"time_of_day\\\": \\\"LATE AFTERNOON\\\",\\n  \\\"int_ext\\\": \\\"EXT\\\",\\n  \\\"characters_present\\\": [\\\"YOUNG MARINER\\\", \\\"DAD\\\"],\\n  \\\"narrative_beats\\\": [\\n    {\\n      \\\"beat_type\\\": \\\"character_introduction\\\",\\n      \\\"description\\\": \\\"Young Mariner (age 8) and his Dad are introduced together on a small sailboat, establishing their close bond and a humble, coastal way of life. Dad's dialect and sun-weathered appearance ground them in a specific working-class maritime culture.\\\",\\n      \\\"confidence\\\": 0.95\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"character_development\\\",\\n      \\\"description\\\": \\\"Dad patiently teaches his son to fish, reframing the boy's imperfect cast as a success. This reveals Dad as a nurturing, encouraging father figure.\\\",\\n      \\\"confidence\\\": 0.9\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"thematic_statement\\\",\\n      \\\"description\\\": \\\"Young Mariner asks 'What's a hero?' and Dad defines heroism as doing the right thing when it's hard and when nobody's watching — establishing a core thematic throughline likely central to the Mariner's later journey.\\\",\\n      \\\"confidence\\\": 0.97\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"foreshadowing\\\",\\n      \\\"description\\\": \\\"Dad's long pause before admitting he 'tries' to be a hero every day hints at personal struggles, moral complexity, or a future event where this ideal will be tested or where Dad may fall short or be lost.\\\",\\n      \\\"confidence\\\": 0.85\\n    },\\n    {\\n      \\\"beat_type\\\": \\\"comic_relief\\\",\\n      \\\"description\\\": \\\"The scene ends with joyful energy as Young Mariner hooks a fish and they scramble together to reel it in, providing a burst of warmth and levity after the reflective moment.\\\",\\n      \\\"confidence\\\": 0.8\\n    }\\n  ],\\n  \\\"tone_mood\\\": \\\"warm and nostalgic with an undercurrent of gentle melancholy\\\",\\n  \\\"tone_shifts\\\": [\\n    \\\"lighthearted fishing lesson to reflective philosophical exchange\\\",\\n    \\\"reflective exchange to bittersweet tenderness\\\",\\n    \\\"bittersweet tenderness to joyful exuberance\\\"\\n  ]\\n}\\n```\\n</Output>\\n<Rubric>\\nEvaluate the scene enrichment for a flashback scene from \\\"The Mariner.\\\"\\n\\nA young boy and his father fishing on a coastline. Key elements:\\n\\n1. Does it correctly identify the exterior coastline/ocean location?\\n2. Does it identify both Young Mariner and Dad?\\n3. Does it capture the warm, nostalgic, idyllic tone?\\n4. Does it identify the thematic statement (\\\"what's a hero\\\")?\\n5. Does it note this as a flashback/idealized memory?\\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\\n7. Does it capture the father-son bonding as character development?\\n\\nScore strictly: the thematic weight of this scene is critical — it\\nestablishes the hero myth that later crumbles.\\n\\n</Rubric>\"}]"
              }
            }
          ]
        },
        "id": "ae2b5fe6-cdea-401e-828d-09ac3981c014",
        "latencyMs": 12187,
        "namedScores": {},
        "prompt": {
          "raw": "You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\nA small sailboat floats on calm water near a rocky coastline. A golden afternoon sun paints everything warm.\n\nYOUNG MARINER (8, scrawny, gap-toothed) sits on the bow, legs dangling. DAD (late 30s, wiry, sun-weathered) crouches beside him with a fishing rod.\n\nDAD\nNow den, b'y, ya gotta feel the line. Don't watch it — feel it.\n\nYoung Mariner nods, tongue poking out in concentration. He casts — the line arcs beautifully and drops right into a patch of kelp.\n\nDAD\nHa! Perfect cast, right inta the kitchen. That's where the big ones hide.\n\nYOUNG MARINER\nDad, what's a hero?\n\nDad pauses, looks out at the water, then back at his son.\n\nDAD\nA hero's someone who does the right thing even when it's hard. Even when nobody's watchin'. Especially then.\n\nYOUNG MARINER\nIs that what you are?\n\nDAD\n(long pause)\nI try to be, b'y. Every day I try.\n\nHe ruffles the boy's hair. Young Mariner beams. The sun catches them both in silhouette — a perfect father-son moment.\n\nThe line jerks. Young Mariner's eyes go wide.\n\nYOUNG MARINER\nDad! Dad! I got one!\n\nDAD\nWell haul 'er in, me son! Haul 'er in!\n\nThey laugh together, wrestling with the rod as the boat rocks gently.\n==========",
          "label": "prompts/scene-enrichment.txt: You are a professional screenplay analyst. Extract scene-level metadata from the following scene excerpt.\n\nReturn a JSON object with these fields:\n- heading: The scene heading in standard format (e.g., \"INT. OFFICE - DAY\"). Infer from context if not explicitly stated.\n- location: The location name (without INT/EXT and time of day)\n- time_of_day: e.g., \"DAY\", \"NIGHT\", \"DAWN\", \"CONTINUOUS\". Infer from context clues.\n- int_ext: One of \"INT\", \"EXT\", or \"INT/EXT\"\n- characters_present: Array of character names who appear or speak in this scene\n- narrative_beats: Array of objects, each with:\n  - beat_type: e.g., \"character_introduction\", \"revelation\", \"conflict\", \"comic_relief\", \"thematic_statement\", \"action\", \"foreshadowing\", \"character_development\"\n  - description: 1-2 sentence description of the beat\n  - confidence: float 0-1\n- tone_mood: Overall tone/mood of the scene (e.g., \"tense\", \"warm\", \"dark comedy\")\n- tone_shifts: Array of tone changes within the scene (e.g., [\"tense to comic relief\", \"comic relief to conflict\"])\n\nImportant:\n- Infer location and time from context if not given as a heading\n- Identify ALL characters who speak or are described, including those referred to by name\n- Narrative beats should capture key story moments, not just action descriptions\n- Be specific about tone — \"dark comedy\" is better than \"mixed\"\n\nReturn ONLY valid JSON. No explanations or markdown fences.\n\n==========\nSCENE EXCERPT:\n{{scene_text}}\n==========",
          "config": {
            "provider": "anthropic:messages:claude-opus-4-6"
          }
        },
        "promptId": "74d37746f3139a4a3a6d9cbcf0d3e7a4331cd4c367951094f31b2255638c27d6",
        "promptIdx": 7,
        "provider": {
          "id": "anthropic:messages:claude-opus-4-6",
          "label": "Claude Opus 4.6"
        },
        "response": {
          "output": "```json\n{\n  \"heading\": \"EXT. SAILBOAT / ROCKY COASTLINE - LATE AFTERNOON\",\n  \"location\": \"SAILBOAT / ROCKY COASTLINE\",\n  \"time_of_day\": \"LATE AFTERNOON\",\n  \"int_ext\": \"EXT\",\n  \"characters_present\": [\"YOUNG MARINER\", \"DAD\"],\n  \"narrative_beats\": [\n    {\n      \"beat_type\": \"character_introduction\",\n      \"description\": \"Young Mariner (age 8) and his Dad are introduced together on a small sailboat, establishing their close bond and a humble, coastal way of life. Dad's dialect and sun-weathered appearance ground them in a specific working-class maritime culture.\",\n      \"confidence\": 0.95\n    },\n    {\n      \"beat_type\": \"character_development\",\n      \"description\": \"Dad patiently teaches his son to fish, reframing the boy's imperfect cast as a success. This reveals Dad as a nurturing, encouraging father figure.\",\n      \"confidence\": 0.9\n    },\n    {\n      \"beat_type\": \"thematic_statement\",\n      \"description\": \"Young Mariner asks 'What's a hero?' and Dad defines heroism as doing the right thing when it's hard and when nobody's watching — establishing a core thematic throughline likely central to the Mariner's later journey.\",\n      \"confidence\": 0.97\n    },\n    {\n      \"beat_type\": \"foreshadowing\",\n      \"description\": \"Dad's long pause before admitting he 'tries' to be a hero every day hints at personal struggles, moral complexity, or a future event where this ideal will be tested or where Dad may fall short or be lost.\",\n      \"confidence\": 0.85\n    },\n    {\n      \"beat_type\": \"comic_relief\",\n      \"description\": \"The scene ends with joyful energy as Young Mariner hooks a fish and they scramble together to reel it in, providing a burst of warmth and levity after the reflective moment.\",\n      \"confidence\": 0.8\n    }\n  ],\n  \"tone_mood\": \"warm and nostalgic with an undercurrent of gentle melancholy\",\n  \"tone_shifts\": [\n    \"lighthearted fishing lesson to reflective philosophical exchange\",\n    \"reflective exchange to bittersweet tenderness\",\n    \"bittersweet tenderness to joyful exuberance\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 1346,
            "prompt": 763,
            "completion": 583
          },
          "finishReason": "stop",
          "cost": 0.01839
        },
        "score": 0.8275,
        "success": true,
        "testCase": {
          "vars": {
            "scene_text": "file://../input/enrich-scene-flashback.txt",
            "golden_path": "golden/enrich-scenes-golden.json",
            "scene_key": "flashback"
          },
          "assert": [
            {
              "type": "python",
              "value": "file://../scorers/scene_enrichment_scorer.py"
            },
            {
              "type": "llm-rubric",
              "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
            }
          ],
          "options": {
            "provider": "anthropic:messages:claude-opus-4-6"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      }
    ],
    "stats": {
      "successes": 9,
      "failures": 7,
      "errors": 0,
      "tokenUsage": {
        "prompt": 12658,
        "completion": 7627,
        "cached": 0,
        "total": 20285,
        "numRequests": 16,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 20169,
          "prompt": 13026,
          "completion": 7143,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      },
      "durationMs": 101293
    }
  },
  "config": {
    "tags": {},
    "description": "Scene enrichment — infer metadata from scene excerpts (The Mariner)",
    "prompts": [
      "file:///Users/cam/Documents/Projects/cine-forge/benchmarks/prompts/scene-enrichment.txt"
    ],
    "providers": [
      {
        "id": "openai:gpt-4.1-nano",
        "label": "GPT-4.1 Nano",
        "config": {
          "temperature": 0,
          "max_tokens": 4096,
          "response_format": {
            "type": "json_object"
          }
        }
      },
      {
        "id": "openai:gpt-4.1-mini",
        "label": "GPT-4.1 Mini",
        "config": {
          "temperature": 0,
          "max_tokens": 4096,
          "response_format": {
            "type": "json_object"
          }
        }
      },
      {
        "id": "google:gemini-2.5-flash-lite",
        "label": "Gemini 2.5 Flash Lite",
        "config": {
          "temperature": 0,
          "maxOutputTokens": 16384
        }
      },
      {
        "id": "openai:gpt-4.1",
        "label": "GPT-4.1",
        "config": {
          "temperature": 0,
          "max_tokens": 4096,
          "response_format": {
            "type": "json_object"
          }
        }
      },
      {
        "id": "anthropic:messages:claude-haiku-4-5-20251001",
        "label": "Claude Haiku 4.5",
        "config": {
          "temperature": 0,
          "max_tokens": 4096
        }
      },
      {
        "id": "anthropic:messages:claude-sonnet-4-5-20250929",
        "label": "Claude Sonnet 4.5",
        "config": {
          "temperature": 0,
          "max_tokens": 4096
        }
      },
      {
        "id": "anthropic:messages:claude-sonnet-4-6",
        "label": "Claude Sonnet 4.6",
        "config": {
          "temperature": 0,
          "max_tokens": 4096
        }
      },
      {
        "id": "google:gemini-2.5-flash",
        "label": "Gemini 2.5 Flash",
        "config": {
          "temperature": 0,
          "maxOutputTokens": 16384
        }
      },
      {
        "id": "google:gemini-3-flash-preview",
        "label": "Gemini 3 Flash",
        "config": {
          "temperature": 0,
          "maxOutputTokens": 16384
        }
      },
      {
        "id": "openai:gpt-5.2",
        "label": "GPT-5.2",
        "config": {
          "temperature": 0,
          "max_tokens": 4096,
          "response_format": {
            "type": "json_object"
          }
        }
      },
      {
        "id": "anthropic:messages:claude-opus-4-6",
        "label": "Claude Opus 4.6",
        "config": {
          "temperature": 0,
          "max_tokens": 4096
        }
      },
      {
        "id": "google:gemini-2.5-pro",
        "label": "Gemini 2.5 Pro",
        "config": {
          "temperature": 0,
          "maxOutputTokens": 16384
        }
      },
      {
        "id": "google:gemini-3-pro-preview",
        "label": "Gemini 3 Pro",
        "config": {
          "temperature": 0,
          "maxOutputTokens": 16384
        }
      }
    ],
    "tests": [
      {
        "vars": {
          "scene_text": "file://../input/enrich-scene-elevator.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "elevator"
        },
        "assert": [
          {
            "type": "python",
            "value": "file://../scorers/scene_enrichment_scorer.py"
          },
          {
            "type": "llm-rubric",
            "value": "Evaluate the scene enrichment for an elevator scene from \"The Mariner.\"\n\nThe scene takes place inside an elevator in a building. Rose and Mariner\nare escaping after a violent rescue. Key elements:\n\n1. Does it correctly identify the interior location (elevator/building)?\n2. Does it identify both Rose and Mariner as present?\n3. Does it capture the dark comedy tone (skull fragment, muzak contrast)?\n4. Does it identify the character introduction beat (Mariner's costume description)?\n5. Does it note the AirTag revelation as a conflict/trust beat?\n6. Does it recognize the tonal juxtaposition (muzak vs violence)?\n7. Are narrative beats specific and grounded in the text?\n\nScore strictly: good enrichment captures subtext and tonal nuance, not just plot.\n"
          }
        ]
      },
      {
        "vars": {
          "scene_text": "file://../input/enrich-scene-flashback.txt",
          "golden_path": "golden/enrich-scenes-golden.json",
          "scene_key": "flashback"
        },
        "assert": [
          {
            "type": "python",
            "value": "file://../scorers/scene_enrichment_scorer.py"
          },
          {
            "type": "llm-rubric",
            "value": "Evaluate the scene enrichment for a flashback scene from \"The Mariner.\"\n\nA young boy and his father fishing on a coastline. Key elements:\n\n1. Does it correctly identify the exterior coastline/ocean location?\n2. Does it identify both Young Mariner and Dad?\n3. Does it capture the warm, nostalgic, idyllic tone?\n4. Does it identify the thematic statement (\"what's a hero\")?\n5. Does it note this as a flashback/idealized memory?\n6. Does it recognize foreshadowing (Dad's definition of heroism)?\n7. Does it capture the father-son bonding as character development?\n\nScore strictly: the thematic weight of this scene is critical — it\nestablishes the hero myth that later crumbles.\n"
          }
        ]
      }
    ],
    "scenarios": [],
    "env": {},
    "defaultTest": {
      "options": {
        "provider": "anthropic:messages:claude-opus-4-6"
      },
      "vars": {},
      "assert": [],
      "metadata": {}
    },
    "outputPath": [
      "results/scene-enrichment-2026-02-18.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {}
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.120.24",
    "nodeVersion": "v24.13.1",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2026-02-18T07:32:43.466Z",
    "evaluationCreatedAt": "2026-02-18T07:31:01.274Z"
  }
}